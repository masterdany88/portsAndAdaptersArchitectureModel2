<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all together – @herbertograca</title>
		<script src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/remote-login.php" type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel="dns-prefetch" href="https://s2.wp.com/">
<link rel="dns-prefetch" href="https://s1.wp.com/">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://herbertograca.wordpress.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="alternate" type="application/rss+xml" title="@herbertograca » Feed" href="https://herbertograca.com/feed/">
<link rel="alternate" type="application/rss+xml" title="@herbertograca » Comments Feed" href="https://herbertograca.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="@herbertograca » DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all&nbsp;together Comments Feed" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1505864856h&ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="all-css-0-1" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a.css" type="text/css" media="all">
<style id="independent-publisher-2-style-inline-css" type="text/css">
#hero-header { background: url("https://herbertograca.files.wordpress.com/2018/11/100-explicit-architecture-svg.png?w=1440&#038;h=600&#038;crop=1") no-repeat center; background-size: cover; background-attachment: scroll; }
</style>
<link rel="stylesheet" id="print-css-1-1" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/global-print.css" type="text/css" media="print">
<link rel="stylesheet" id="all-css-2-1" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_002.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_005.js"></script>
<link rel="stylesheet" id="all-css-0-2" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://herbertograca.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Service Oriented Architecture&nbsp;(SOA)" href="https://herbertograca.com/2017/11/09/service-oriented-architecture-soa/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a.html">
<link rel="shortlink" href="https://wp.me/p6DnXN-3RU">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all together">
<meta property="og:url" content="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/">
<meta property="og:description" content="In my last posts I’ve been writing about many of the concepts and principles that I’ve learned and a bit about how I reason about them. But I see these as just pieces of big a puzzle.&nbsp;
…">
<meta property="article:published_time" content="2017-11-16T14:30:54+00:00">
<meta property="article:modified_time" content="2017-12-02T12:01:18+00:00">
<meta property="og:site_name" content="@herbertograca">
<meta property="og:image" content="https://herbertograca.files.wordpress.com/2018/11/100-explicit-architecture-svg.png?w=1200">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="821">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@hgraca">
<meta name="twitter:text:title" content="DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all&nbsp;together">
<meta name="twitter:image:src" content="https://herbertograca.files.wordpress.com/2018/11/100-explicit-architecture-svg.png?w=640">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@hgraca">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/448a31aa6850fbccb7cc0021392a0d0b?s=32" sizes="16x16">
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/448a31aa6850fbccb7cc0021392a0d0b?s=32" sizes="16x16">
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/448a31aa6850fbccb7cc0021392a0d0b?s=114">
<link rel="openid.server" href="https://herbertograca.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://herbertograca.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://herbertograca.com/osd.xml" title="@herbertograca">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<link rel="pingback" href="https://herbertograca.com/xmlrpc.php"><meta name="application-name" content="@herbertograca"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://herbertograca.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/448a31aa6850fbccb7cc0021392a0d0b?s=16"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="title" content="DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all&nbsp;together | @herbertograca on WordPress.com">
<meta name="description" content="In my last posts I've been writing about many of the concepts and principles that I've learned and a bit about how I reason about them. But I see these as just pieces of big a puzzle.&nbsp; Todays post is about how I fit all of these pieces together.">
		<script type="text/javascript">
		var __ATA_PP = { pt: 1, ht: 0, tn: 'independent-publisher-2', amp: false };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/publishertag.js"></script>
		<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/head.js" async=""></script><link rel="amphtml" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'none']);
	_gaq.push(['_setAllowLinker', true]);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ga.js"></script>
<style type="text/css"></style><script type="text/javascript" async="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a.js"></script><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/services.css"><script type="text/javascript" async="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_004.js"></script></head>

<body class="post-template-default single single-post postid-14874 single-format-standard mp6 customizer-styles-applied has-sidebar has-header-image highlander-enabled highlander-light tablet-desktop">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<div id="hero-header" class="site-hero-section">
		<header id="masthead" class="site-header" role="banner">
			<div class="inner">
				<div class="site-branding">
					
											<a class="site-logo-link" href="https://herbertograca.com/">
							<img alt="" class="site-logo-image no-grav" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_003.jpeg" width="80" height="80">
						</a><!-- .site-logo-link -->
													<p class="site-title"><a href="https://herbertograca.com/" rel="home">@herbertograca</a></p>
										</div><!-- .site-branding -->

				
				
			</div><!-- .inner -->
		</header><!-- #masthead -->
	</div>

		
	
	
	<div id="content-wrapper" class="content-wrapper">
		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-14874" class="post-14874 post type-post status-publish format-standard has-post-thumbnail hentry category-architecture category-development category-series category-the-software-architecture-chronicles category-uncategorized tag-architecture-2 tag-explicit-architecture tag-software-architecture tag-software-development">
			<header class="entry-header">
			<h1 class="entry-title">DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all&nbsp;together</h1>		</header><!-- .entry-header -->		<div class="entry-meta">
			<span class="byline">
				<a href="https://herbertograca.com/author/hgraca/" title="Posts by hgraca" rel="author">hgraca</a>			</span>
							<span class="cat-links">
					<a href="https://herbertograca.com/category/development/architecture/" rel="category tag">Architecture</a>, <a href="https://herbertograca.com/category/development/" rel="category tag">Development</a>, <a href="https://herbertograca.com/category/development/series/" rel="category tag">Series</a>, <a href="https://herbertograca.com/category/development/series/the-software-architecture-chronicles/" rel="category tag">The Software Architecture Chronicles</a>, <a href="https://herbertograca.com/category/uncategorized/" rel="category tag">Uncategorized</a>				</span><!-- .cat-links -->
			
			
			<span class="published-on">
				<time class="entry-date published" datetime="2017-11-16T15:30:54+00:00">November 16, 2017</time><time class="updated" datetime="2017-12-02T13:01:18+00:00">December 2, 2017</time>			</span>

			<span class="word-count">17 Minutes</span>		</div><!-- .entry-meta -->
	
	<div class="entry-content">
		<p style="text-align:justify;"><i>This post is part of </i><i><a href="https://herbertograca.com/2017/07/03/the-software-architecture-chronicles/" target="_blank" rel="noopener">The Software Architecture Chronicles</a></i><i>, a </i><i><a href="https://herbertograca.com/category/development/series/software-architecture/">series of posts about Software Architecture</a></i><i>.
 In them, I write about what I’ve learned on Software Architecture, how I
 think of it, and how I use that knowledge. The contents of this post 
might make more sense if you read the previous posts in this series.</i></p>
<p style="text-align:justify;">After graduating from University I 
followed a career as a high school teacher until a few years ago I 
decided to drop it and become a full-time software developer.</p>
<p style="text-align:justify;">From then on, I have always felt like I 
need to recover the “lost” time and learn as much as possible, as fast 
as possible. So I have become a bit of an addict in experimenting, 
reading and writing, with a special focus on software design and 
architecture. That’s why I write these posts, to help me learn.</p>
<p style="text-align:justify;">In my last posts, I’ve been writing about
 many of the concepts and principles that I’ve learned and a bit about 
how I reason about them. But I see these as just pieces of big a puzzle.</p>
<p style="text-align:justify;">Today’s post is about how I fit all of these pieces together and, as it seems I should give it a name, I call it <strong>Explicit Architecture</strong>. Furthermore, these concepts have all “<em>passed their battle trials</em>”
 and are used in production code on highly demanding platforms.&nbsp;One
 is a SaaS e-com platform with thousands of web-shops worldwide, another
 one is a marketplace, live in 2 countries with a message bus that 
handles over 20 million messages per month.</p>
<ul>
<li><a href="#fundamental-blocks-of-the-system">Fundamental blocks of the system</a></li>
<li><a href="#tools">Tools</a></li>
<li><a href="#connecting-the-tools-and-the-application-core">Connecting the tools and delivery mechanisms to the Application Core</a>
<ul>
<li><a href="#ports">Ports</a></li>
<li><a href="#primary-or-driving-adapters">Primary or Driving Adapters</a></li>
<li><a href="#secondary-or-driving-adapters">Secondary or Driven Adapters</a></li>
<li><a href="#inversion-of-control">Inversion of control</a></li>
</ul>
</li>
<li><a href="#application-core-organisation">Application Core Organisation</a>
<ul>
<li><a href="#application-layer">Application Layer</a></li>
<li><a href="#domain-layer">Domain Layer</a>
<ul>
<li><a href="#domain-services">Domain Services</a></li>
<li><a href="#domain-model">Domain Model</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#components">Components</a>
<ul>
<li><a href="#decoupling-the-components">Decoupling the components</a>
<ul>
<li><a href="#triggering-logic-in-other-components">Triggering logic in other components</a></li>
<li><a href="#getting-data-from-other-components">Getting data from other components</a>
<ul>
<li><a href="#data-storage-shared-between-components">Data storage shared between components</a></li>
<li><a href="#data-storage-segregated-per-component">Data storage segregated per component</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#flow-of-control">Flow of control</a></li>
</ul>
<p style="text-align:justify;"><span id="more-14874"></span></p>
<h2 id="fundamental-blocks-of-the-system" style="text-align:justify;"><strong>Fundamental blocks of the system</strong></h2>
<p style="text-align:justify;">I start by recalling <a href="https://herbertograca.com/2017/08/24/ebi-architecture/"><strong>EBI</strong></a> and <strong><a href="https://herbertograca.com/2017/09/14/ports-adapters-architecture/" target="_blank" rel="noopener">Ports &amp; Adapters</a></strong>
 architectures. Both of them make an explicit separation of what code is
 internal to the application, what is external, and what is used for 
connecting internal and external code.</p>
<p style="text-align:justify;">Furthermore,&nbsp;<strong><a href="https://herbertograca.com/2017/09/14/ports-adapters-architecture/" target="_blank" rel="noopener">Ports &amp; Adapters</a></strong> architecture explicitly identifies three fundamental blocks of code in a system:</p>
<ul style="text-align:justify;">
<li style="text-align:justify;">What makes it possible to run a <strong>user interface</strong>, whatever type of user interface it might be;</li>
<li style="text-align:justify;">The system <strong>business logic</strong>, or&nbsp;<strong>application core</strong>, which is used by the user interface to actually make things happen;</li>
<li style="text-align:justify;"><strong>Infrastructure</strong> code, that connects our application core to tools like a database, a search engine or 3rd party APIs.</li>
</ul>
<p style="text-align:justify;"><img data-attachment-id="16258" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/000-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="000 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16258 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/000-explicit-architecture-svg.png" alt="000 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/000-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">The application core is what we should 
really care about. It is the code that allows our code to do what it is 
supposed to do, it IS our application. It might use several user 
interfaces (progressive web app, mobile, CLI, API, …) but the code 
actually doing the work is the same and is located in the application 
core, it shouldn’t really matter what UI triggers it.</p>
<p style="text-align:justify;">As you can imagine, the typical 
application flow goes from the code in the user interface, through the 
application core to the infrastructure code, back to the application 
core and finally deliver a response to the user interface.</p>
<p style="text-align:justify;"><img data-attachment-id="16257" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/010-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="010 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16257 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/010-explicit-architecture-svg.png" alt="010 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/010-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<h2 id="tools" style="text-align:justify;"><strong>Tools</strong></h2>
<p style="text-align:justify;">Far away from the most important code in 
our system, the application core, we have the tools that our application
 uses, for example, a database engine, a search engine, a Web server or a
 CLI console (although the last two are also delivery mechanisms).</p>
<p style="text-align:justify;"><img data-attachment-id="16256" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/020-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="020 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16256 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/020-explicit-architecture-svg.png" alt="020 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/020-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">While it might feel weird to put a CLI 
console in the same “bucket” as a database engine, and although they 
have different types of purposes, they are in fact tools used by the 
application. The key difference is that, while the CLI console and the 
web server are used to <strong><span style="text-decoration:underline;">tell</span> our application to do something</strong>, the database engine is <strong><span style="text-decoration:underline;">told</span> by our application to do something</strong>.
 This is a very relevant distinction, as it has strong implications on 
how we build the code that connects those tools with the application 
core.</p>
<h2 id="connecting-the-tools-and-the-application-core" style="text-align:justify;"><strong>Connecting the tools and delivery mechanisms to the Application Core</strong></h2>
<p style="text-align:justify;">The code units that connect the tools to the application core are called adapters (<a href="https://herbertograca.com/2017/09/14/ports-adapters-architecture/" target="_blank" rel="noopener">Ports &amp; Adapters Architecture</a>).
 The adapters are the ones that effectively implement the code that will
 allow the business logic to communicate with a specific tool and 
vice-versa.</p>
<p style="text-align:justify;">The adapters that <strong>tell</strong> our application to do something are called&nbsp;<strong>Primary or Driving Adapters</strong>&nbsp;while&nbsp;the ones that are <strong>told</strong> by our application to do something are called&nbsp;<strong>Secondary or Driven Adapters</strong>.</p>
<h3 id="ports">Ports</h3>
<p style="text-align:justify;">These <em>Adapters</em>, however, are not randomly created. They are created to fit a very specific entry point to the Application Core, a <strong><em>Port</em></strong>. A port <strong>is nothing more than a specification</strong>
 of how the tool can use the application core, or how it is used by the 
Application Core. In most languages and in its most simple form, this 
specification, the Port, will be an Interface, but it might actually be 
composed of several Interfaces and DTOs.</p>
<p style="text-align:justify;">It’s important to note that <strong>the Ports (Interfaces) belong inside the business logic</strong>,
 while the adapters belong outside. For this pattern to work as it 
should, it is of utmost importance that the Ports are created to fit the
 Application Core needs and not simply mimic the tools APIs.</p>
<h3 id="primary-or-driving-adapters" style="text-align:justify;">Primary or Driving Adapters</h3>
<p style="text-align:justify;">The Primary or <strong>Driver Adapters <span style="text-decoration:underline;">wrap</span> around a Port</strong> and use it to tell the Application Core what to do.&nbsp;<strong>They translate whatever comes from a delivery mechanism into a method call in the Application Core.</strong></p>
<p style="text-align:justify;"><img data-attachment-id="16255" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/030-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="030 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16255 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/030-explicit-architecture-svg.png" alt="030 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/030-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">In other words, our Driving Adapters are 
Controllers or Console Commands who are injected in their constructor 
with some object whose class implements the interface (Port) that the 
controller or console command requires.</p>
<p style="text-align:justify;">In a more concrete example, a Port can be
 a Service interface or a Repository interface that a controller 
requires. The concrete implementation of the Service, Repository or 
Query is then injected and used in the Controller.</p>
<p style="text-align:justify;">Alternatively, a Port can be a Command 
Bus or Query Bus interface. In this case, a concrete implementation of 
the Command or Query Bus is injected into the Controller, who then 
constructs a Command or Query and passes it to the relevant Bus.</p>
<h3 id="secondary-or-driving-adapters" style="text-align:justify;">Secondary or Driven Adapters</h3>
<p style="text-align:justify;">Unlike the Driver Adapters, who wrap around a port, <strong>the Driven Adapters <span style="text-decoration:underline;">implement</span> a Port</strong>, an interface, and are then injected into the Application Core, wherever the port is required (type-hinted).</p>
<p><img data-attachment-id="16254" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/040-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="040 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16254 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/040-explicit-architecture-svg.png" alt="040 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/040-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">For example, let’s suppose that we have a
 naive application which needs to persist data. So we create a 
persistence interface that meets its needs, with a method to <em>save</em> an array of data and a method to <em>delete</em>
 a line in a table by its ID. From then on, wherever our application 
needs to save or delete data we will require in its constructor an 
object that implements the persistence interface that we defined.</p>
<p style="text-align:justify;">Now we create an adapter specific to 
MySQL which will implement that interface. It will have the methods to 
save an array and delete a line in a table, and we will inject it 
wherever the persistence interface is required.</p>
<p style="text-align:justify;">If at some point we decide to change the 
database vendor, let’s say to PostgreSQL or MongoDB, we just need to 
create a new adapter that implements the persistence interface and is 
specific to PostgreSQL, and inject the new adapter instead of the old 
one.</p>
<h3 id="inversion-of-control" style="text-align:justify;">Inversion of control</h3>
<p style="text-align:justify;">A characteristic to note about this 
pattern is that the adapters depend on a specific tool and a specific 
port (by implementing an interface). But our business logic only depends
 on the port (interface), which is designed to fit the business logic 
needs, so it doesn’t depend on a specific adapter or tool.</p>
<p style="text-align:justify;"><img data-attachment-id="16253" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/050-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="050 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16253 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/050-explicit-architecture-svg.png" alt="050 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/050-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">This means the direction of dependencies is towards the centre, it’s the <strong>inversion of control principle at the architectural level</strong>.</p>
<p style="text-align:justify;">Although, again,&nbsp;<strong>it is of utmost importance that the Ports are created to fit the Application Core needs and not simply mimic the tools APIs.</strong></p>
<h2 id="application-core-organisation" style="text-align:justify;"><strong>Application Core organisation</strong></h2>
<p style="text-align:justify;">The <a href="https://herbertograca.com/2017/09/21/onion-architecture/" target="_blank" rel="noopener">Onion Architecture</a> picks up the DDD layers and incorporates them into the <a href="https://herbertograca.com/2017/09/14/ports-adapters-architecture/" target="_blank" rel="noopener">Ports &amp; Adapters Architecture</a>.
 Those layers are intended to bring some organisation to the business 
logic, the interior of the Ports &amp; Adapters “hexagon”, and just like
 in Ports &amp; Adapters, the dependencies direction is towards the 
centre.</p>
<h3 id="application-layer" style="text-align:justify;">Application Layer</h3>
<p style="text-align:justify;">The use cases are the processes that can 
be triggered in our Application Core by one or several User Interfaces 
in our application. For example, in a CMS we could have the actual 
application UI used by the common users, another independent UI for the 
CMS administrators, another CLI UI, and a web API. These UIs 
(applications) could trigger use cases that can be specific to one of 
them or reused by several of them.</p>
<p style="text-align:justify;">The use cases are defined in the Application Layer, the first layer provided by DDD and used by the Onion Architecture.</p>
<p style="text-align:justify;"><img data-attachment-id="16252" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/060-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="060 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16252 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/060-explicit-architecture-svg.png" alt="060 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/060-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<p style="text-align:justify;">This layer contains Application Services 
(and their interfaces) as first class citizens, but it also contains the
 Ports &amp; Adapters interfaces (ports) which include ORM interfaces, 
search engines interfaces, messaging interfaces and so on. In the case 
where we are using a Command Bus and/or a Query Bus, this layer is where
 the respective Handlers for the Commands and Queries belong.</p>
<p style="text-align:justify;">The Application Services and/or Command 
Handlers contain the logic to unfold a use case, a business process. 
Typically, their role is to:</p>
<ol style="text-align:justify;">
<li>use a repository to find one or several entities;</li>
<li>tell those entities to do some domain logic;</li>
<li>and use the repository to persist the entities again, effectively saving the data changes.</li>
</ol>
<p style="text-align:justify;"><span style="text-align:justify;">The Command Handlers can be used in two different ways:</span></p>
<ol style="text-align:justify;">
<li>They can contain the actual logic to perform the use case;</li>
<li style="text-align:justify;">They can be used as mere wiring pieces 
in our architecture, receiving a Command and simply triggering logic 
that exists in an Application Service.</li>
</ol>
<p style="text-align:justify;">Which approach to use depends on the context, for example:</p>
<ul style="text-align:justify;">
<li>Do we already have the Application Services in place and are now adding a Command Bus?</li>
<li>Does the Command Bus allow specifying any class/method as a handler,
 or do they need to extend or implement existing classes or interfaces?</li>
</ul>
<p style="text-align:justify;">This layer also contains the triggering of&nbsp;<strong>Application Events</strong>,
 which represent some outcome of a use case. These events trigger logic 
that is a side effect of a use case, like sending emails, notifying a 
3rd party API, sending a push notification, or even starting another use
 case that belongs to a different component of the application.</p>
<h3 id="domain-layer" style="text-align:justify;">Domain Layer</h3>
<p style="text-align:justify;">Further inwards, we have the Domain 
Layer. The objects in this layer contain the data and the logic to 
manipulate that data, that is specific to the Domain itself and it’s 
independent of the business processes that trigger that logic, they are 
independent and completely unaware of the Application Layer.</p>
<p style="text-align:justify;"><img data-attachment-id="16251" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/070-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="070 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16251 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/070-explicit-architecture-svg.png" alt="070 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/070-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<h4 id="domain-services" style="text-align:justify;">Domain Services</h4>
<p style="text-align:justify;">As I mentioned above, the role of an Application Service is to:</p>
<ol style="text-align:justify;">
<li>use a repository to find one or several entities;</li>
<li>tell those entities to do some domain logic;</li>
<li>and use the repository to persist the entities again, effectively saving the data changes.</li>
</ol>
<p style="text-align:justify;">However, sometimes we encounter some 
domain logic that involves different entities, of the same type or not, 
and we feel that that domain logic does not belong in the entities 
themselves, we feel that that logic is not their direct responsibility.</p>
<p style="text-align:justify;">So our first reaction might be to place 
that logic outside the entities, in an Application Service. However, 
this means that&nbsp;that domain logic will not be reusable in other use
 cases: domain logic should stay out of the application layer!</p>
<p style="text-align:justify;">The solution is to create a Domain 
Service, which has the role of receiving a set of entities and 
performing some business logic on them. A Domain Service belongs to the 
Domain Layer, and therefore it knows nothing about the classes in the 
Application Layer, like the Application Services or the Repositories. In
 the other hand, it can use other Domain Services and, of course, the 
Domain Model objects.</p>
<h4 id="domain-model" style="text-align:justify;">Domain Model</h4>
<p style="text-align:justify;">In the very centre, depending on nothing 
outside it, is the Domain Model, which contains the business objects 
that represent something in the domain. Examples of these objects are, 
first of all, Entities but also Value Objects, Enums and any objects 
used in the Domain Model.</p>
<p style="text-align:justify;">The Domain Model is also where Domain 
Events “live”. These events are triggered when a specific set of data 
changes and they carry those changes with them. In other words, when an 
entity changes, a Domain Event is triggered and it carries the changed 
properties new values. These events are perfect, for example, to be used
 in Event Sourcing.</p>
<h2 id="components" style="text-align:justify;"><strong>Components</strong></h2>
<p style="text-align:justify;">So far we have been segregating the code 
based on layers, but that is the fine-grained code segregation. The 
coarse-grained segregation of code is at least as important and it’s 
about segregating the code according to sub-domains and <a href="http://ddd.fed.wiki.org/view/welcome-visitors/view/domain-driven-design/view/bounded-context" target="_blank" rel="noopener"><strong><em>bounded</em><em> contexts</em></strong></a>, following Robert C. Martin ideas expressed in&nbsp;<em><strong><a href="https://8thlight.com/blog/uncle-bob/2011/09/30/Screaming-Architecture.html" target="_blank" rel="noopener">screaming architecture</a></strong></em>. This is often referred to as “<em>Package by feature</em>” or “<em>Package by component</em>” as opposed to”<em>Package by layer</em>“, and it’s quite well explained by Simon Brown in his blog post&nbsp;“<a href="http://www.codingthearchitecture.com/2015/03/08/package_by_component_and_architecturally_aligned_testing.html" target="_blank" rel="noopener">Package by component and architecturally-aligned testing</a>“:</p>
<div class="tiled-gallery type-square" data-original-width="1100" data-carousel-extra="{&quot;blog_id&quot;:98044927,&quot;permalink&quot;:&quot;https:\/\/herbertograca.com\/2017\/11\/16\/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together\/&quot;,&quot;likes_blog_id&quot;:98044927}"> <div class="gallery-row" style="width: 740px; height: 246px;" data-original-width="1100" data-original-height="366"> <div class="gallery-group" style="width: 246px; height: 246px;" data-original-width="366" data-original-height="366"> <div class="tiled-gallery-item" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-layer.png" border="0" itemprop="url"> <meta itemprop="width" content="362"> <meta itemprop="height" content="362"> <img data-attachment-id="16613" data-orig-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-layer.png" data-orig-size="1024,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="20150308-package-by-layer" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-layer.png?w=300" data-large-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-layer.png?w=1024" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/20150308-package-by-layer.png" data-original-width="362" data-original-height="362" itemprop="http://schema.org/image" title="20150308-package-by-layer" alt="20150308-package-by-layer" style="width: 242px; height: 242px;" width="362" height="362"> </a> </div> </div> <div class="gallery-group" style="width: 246px; height: 246px;" data-original-width="366" data-original-height="366"> <div class="tiled-gallery-item" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-feature.png" border="0" itemprop="url"> <meta itemprop="width" content="362"> <meta itemprop="height" content="362"> <img data-attachment-id="16614" data-orig-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-feature.png" data-orig-size="1024,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="20150308-package-by-feature" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-feature.png?w=300" data-large-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-feature.png?w=1024" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/20150308-package-by-feature.png" data-original-width="362" data-original-height="362" itemprop="http://schema.org/image" title="20150308-package-by-feature" alt="20150308-package-by-feature" style="width: 242px; height: 242px;" width="362" height="362"> </a> </div> </div> <div class="gallery-group" style="width: 246px; height: 246px;" data-original-width="366" data-original-height="366"> <div class="tiled-gallery-item" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-component.png" border="0" itemprop="url"> <meta itemprop="width" content="362"> <meta itemprop="height" content="362"> <img data-attachment-id="16615" data-orig-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-component.png" data-orig-size="1024,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="20150308-package-by-component" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-component.png?w=300" data-large-file="https://herbertograca.files.wordpress.com/2017/11/20150308-package-by-component.png?w=1024" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/20150308-package-by-component.png" data-original-width="362" data-original-height="362" itemprop="http://schema.org/image" title="20150308-package-by-component" alt="20150308-package-by-component" style="width: 242px; height: 242px;" width="362" height="362"> </a> </div> </div> </div> </div>
<p style="text-align:justify;">I am an advocate for the&nbsp;“<em>Package by component</em>” approach and, picking up on Simon Brown diagram about&nbsp;<em>Package by component</em>, I would shamelessly change it to the following:</p>
<p><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/pub_005.png"></p>
<p style="text-align:justify;">These sections of code are cross-cutting to the layers previously described, they are the <em><strong><a href="https://herbertograca.com/2017/07/05/software-architecture-premises/" target="_blank" rel="noopener">components</a></strong></em> of our application. Examples of components can be <del>Authentication, Authorization,</del>
 Billing, User, Review or Account, but they are always related to the 
domain. Bounded contexts like Authorization and/or Authentication should
 be seen as external tools for which we create an adapter and hide 
behind some kind of port.</p>
<p style="text-align:justify;"><img data-attachment-id="16250" data-permalink="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/080-explicit-architecture-svg/" data-orig-file="https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=1100" data-orig-size="1600,1094" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="080 – Explicit Architecture.svg" data-image-description="" data-medium-file="https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=1100?w=300" data-large-file="https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=1100?w=1024" class=" size-full wp-image-16250 aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/080-explicit-architecture-svg.png" alt="080 - Explicit Architecture.svg" srcset="https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=1100 1100w, https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=150 150w, https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=300 300w, https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=768 768w, https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png?w=1024 1024w, https://herbertograca.files.wordpress.com/2018/11/080-explicit-architecture-svg.png 1600w" sizes="(max-width: 1100px) 100vw, 1100px"></p>
<h3 id="decoupling-the-components" style="text-align:justify;">Decoupling the components</h3>
<p style="text-align:justify;">Just like the fine-grained code units 
(classes, interfaces, traits, mixins, …), also the coarsely grained 
code-units (components) benefit from low coupling and high cohesion.</p>
<p style="text-align:justify;">To decouple classes we make use of 
Dependency Injection, by injecting dependencies into a class as opposed 
to instantiating them inside the class, and Dependency Inversion, by 
making the class depend on abstractions (interfaces and/or abstract 
classes) instead of concrete classes. This means that the depending 
class has no knowledge about the concrete class that it is going to use,
 it has no reference to the fully qualified class name of the classes 
that it depends on.</p>
<p style="text-align:justify;">In the same way, having completely 
decoupled components means that a component has no direct knowledge of 
any another component. In other words, it has no reference to any 
fine-grained code unit from another component, not even interfaces! This
 means that Dependency Injection and Dependency Inversion are not enough
 to decouple components, we will need some sort of architectural 
constructs. We might need events, a shared kernel, eventual consistency,
 and even a discovery service!</p>
<p><a href="https://drive.google.com/open?id=1E_hx5B4czRVFVhGJbrbPDlb_JFxJC8fYB86OMzZuAhg" target="_blank" rel="noopener"><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/pub_004.png"></a></p>
<h4 id="triggering-logic-in-other-components" style="text-align:justify;">Triggering logic in other components</h4>
<p style="text-align:justify;">When one of our components (component B) 
needs to do something whenever something else happens in another 
component (component A), we can not simply make a direct call from 
component A to a class/method in component B because A would then be 
coupled to B.</p>
<p style="text-align:justify;">However we can make A use an event 
dispatcher to dispatch an application event that will be delivered to 
any component listening to it, including B, and the event listener in B 
will trigger the desired action. This means that component A will depend
 on an event dispatcher, but it will be decoupled from B.</p>
<p style="text-align:justify;">Nevertheless, if the event itself “lives”
 in A this means that B knows about the existence of A, it is coupled to
 A. To remove this dependency, we can create a library with a set of 
application core functionality that will be shared among all components,
 the <a href="http://ddd.fed.wiki.org/view/welcome-visitors/view/domain-driven-design/view/shared-kernel" target="_blank" rel="noopener">Shared Kernel</a>.
 This means that the components will both depend on the Shared Kernel 
but they will be decoupled from each other. The Shared Kernel will 
contain functionality like application and domain events, but it can 
also contain Specification objects, and whatever makes sense to share, 
keeping in mind that it should be as minimal as possible because any 
changes to the Shared Kernel will affect all components of the 
application. Furthermore, if we have a polyglot system, let’s say a 
micro-services ecosystem where they are written in different languages, 
the Shared Kernel needs to be language agnostic so that it can be 
understood by all components, whatever the language they have been 
written in. For example, instead of the Shared Kernel containing an 
Event class, it will contain the event description (ie. name, 
properties, maybe even methods although these would be more useful in a 
Specification object) in an agnostic language like JSON, so that all 
components/micro-services can interpret it and maybe even auto-generate 
their own concrete implementations.</p>
<p style="text-align:justify;">This approach works both in monolithic 
applications and distributed applications like micro-services 
ecosystems. However, when the events can only be delivered 
asynchronously, for contexts where triggering logic in other components 
needs to be done immediately this approach will not suffice! Component A
 will need to make a direct HTTP call to component B. In this case, to 
have the components decoupled, we will need a discovery service to which
 A will ask where it should send the request to trigger the desired 
action, or alternatively make the request to the discovery service who 
can proxy it to the relevant service and eventually return a response 
back to the requester. This approach will couple the components to the 
discovery service but will keep them decoupled from each other.</p>
<h4 id="getting-data-from-other-components" style="text-align:justify;">Getting data from other components</h4>
<p style="text-align:justify;">The way I see it, a component is not 
allowed to change data that it does not “own”, but it is fine for it to 
query and use any data.</p>
<h5 id="data-storage-shared-between-components" style="text-align:justify;">Data storage shared between components</h5>
<p style="text-align:justify;">When a component needs to use data that 
belongs to another component, let’s say a billing component needs to use
 the client name which belongs to the accounts component, the billing 
component will contain a query object that will query the data storage 
for that data. This simply means that the billing component can know 
about any dataset, but it must use the data that it does not “own” as 
read-only, by the means of queries.</p>
<h5 id="data-storage-segregated-per-component" style="text-align:justify;">Data storage segregated per component</h5>
<p style="text-align:justify;">In this case, the same pattern applies, 
but we have more complexity at the data storage level. Having components
 with their own data storage means each data storage contains:</p>
<ul>
<li style="text-align:justify;">A set of data that it owns and is the only one allowed to change, making it the single source of truth;</li>
<li style="text-align:justify;">A set of data that is a copy of other 
components data, which it can not change on its own, but is needed for 
the component functionality, and it needs to be updated whenever it 
changes in the owner component.</li>
</ul>
<p style="text-align:justify;">Each component will create a local copy 
of the data it needs from other components, to be used when needed. When
 the data changes in the component that owns it, that owner component 
will trigger a domain event carrying the data changes. The components 
holding a copy of that data will be listening to that domain event and 
will update their local copy accordingly.</p>
<h2 id="flow-of-control">Flow of control</h2>
<p style="text-align:justify;">As I said above, the flow of control 
goes, of course, from the user into the Application Core, over to the 
infrastructure tools, back to the Application Core and finally back to 
the user. But how exactly do classes fit together? Which ones depend on 
which ones? How do we compose them?</p>
<p style="text-align:justify;">Following Uncle Bob, in his article about Clean Architecture, I will try to explain the flow of control with UMLish diagrams…</p>
<h3>Without a Command/Query Bus</h3>
<p style="text-align:justify;">In the case we do not use a command bus, the Controllers will depend either on an Application Service or on a Query object.</p>
<p style="font-size:70%;text-align:justify;">[<strong>EDIT – 2017-11-18</strong>] I completely missed the DTO I use to return data from the query, so I added it now. Tkx to&nbsp;<a class="" href="https://www.reddit.com/user/MorphineAdministered" target="_blank" rel="noopener">MorphineAdministered</a>&nbsp;who <a href="https://www.reddit.com/r/PHP/comments/7dcz8k/ddd_hexagonal_onion_clean_cqrs_how_i_put_it_all/dpy6va4/" target="_blank" rel="noopener">pointed it out</a> for me.</p>
<p><img class=" aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/pub_002.png"></p>
<p style="text-align:justify;">In the diagram above we use an interface 
for the Application Service, although we might argue that it is not 
really needed since the Application Service is part of our application 
code and we will not want to swap it for another implementation, 
although we might refactor it entirely.</p>
<p style="text-align:justify;">The Query object will contain an 
optimized query that will simply return some raw data to be shown to the
 user. That data will be returned in a DTO which will be injected into a
 ViewModel. ThisViewModel may have some view logic in it, and it will be
 used to populate a View.</p>
<p style="text-align:justify;">The Application Service, on the other 
hand, will contain the use case logic, the logic we will trigger when we
 want to do something in the system, as opposed to simply view some 
data. The Application Services depend on Repositories which will return 
the Entity(ies) that contain the logic which needs to be triggered. It 
might also depend on a Domain Service to coordinate a domain process in 
several entities, but that is hardly ever the case.</p>
<p style="text-align:justify;">After unfolding the use case, the 
Application Service might want to notify the whole system that that use 
case has happened, in which case it will also depend on an event 
dispatcher to trigger the event.</p>
<p>It is interesting to note that we place interfaces both on the 
persistence engine and on the repositories. Although it might seem 
redundant, they serve different purposes:</p>
<ul>
<li style="text-align:justify;">The persistence interface is an 
abstraction layer over the ORM so we can swap the ORM being used with no
 changes to the Application Core.</li>
<li style="text-align:justify;">The repository interface is an 
abstraction on the persistence engine itself. Let’s say we want to 
switch from MySQL to MongoDB. The persistence interface can be the same,
 and, if we want to continue using the same ORM, even the persistence 
adapter will stay the same.&nbsp;However, the query language is 
completely different, so we can create new repositories which use the 
same persistence mechanism, implement the same repository interfaces but
 builds the queries using the MongoDB query language instead of SQL.</li>
</ul>
<h3>With a Command/Query Bus</h3>
<p style="text-align:justify;">In the case that our application uses a 
Command/Query Bus, the diagram stays pretty much the same, with the 
exception that the controller now depends on the Bus and on a command or
 a Query. It will instantiate the Command or the Query, and pass it 
along to the Bus who will find the appropriate handler to receive and 
handle the command.</p>
<p style="text-align:justify;">In the diagram below, the Command Handler
 then uses an Application Service. However, that is not always needed, 
in fact in most of the cases the handler will contain all the logic of 
the use case. We only need to extract logic from the handler into a 
separated Application Service if we need to reuse that same logic in 
another handler.</p>
<p style="font-size:70%;text-align:justify;">[<strong>EDIT – 2017-11-18</strong>] I completely missed the DTO I use to return data from the query, so I added it now. Tkx to&nbsp;<a class="" href="https://www.reddit.com/user/MorphineAdministered" target="_blank" rel="noopener">MorphineAdministered</a>&nbsp;who <a href="https://www.reddit.com/r/PHP/comments/7dcz8k/ddd_hexagonal_onion_clean_cqrs_how_i_put_it_all/dpy6va4/" target="_blank" rel="noopener">pointed it out</a> for me.</p>
<p><img class=" aligncenter" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/pub_003.png"></p>
<p style="text-align:justify;">You might have noticed that there is no 
dependency between the Bus and the Command, the Query nor the Handlers. 
This is because they should, in fact, be unaware of each other in order 
to provide for good decoupling. The way the Bus will know what Handler 
should handle what Command, or Query, should be set up with mere 
configuration.</p>
<p style="text-align:justify;">As you can see, in both cases all the 
arrows, the dependencies, that cross the border of the application core,
 they point inwards. As explained before, this a fundamental rule of 
Ports &amp; Adapters Architecture, Onion Architecture and Clean 
Architecture.</p>
<p><a href="https://docs.google.com/drawings/d/1DGiP9qyBpRHPDPKRJoXdElw1DXwmJoR-88Qvtf6hBNA/edit?usp=sharing" target="_blank" rel="noopener"><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/pub.png"></a></p>
<h2 id="conclusion" style="text-align:justify;"><strong>Conclusion</strong></h2>
<p style="text-align:justify;">The goal, as always, is to have a 
codebase that is loosely coupled and high cohesive, so that changes are 
easy, fast and safe to make.</p>
<blockquote><p>Plans are worthless, but planning is everything.</p>
<p style="text-align:right;">Eisenhower</p>
</blockquote>
<p style="text-align:justify;">This infographic is a concept map. 
Knowing and understanding all of these concepts will help us plan for a 
healthy architecture, a healthy application.</p>
<p>Nevertheless:</p>
<blockquote><p>The map is not the territory.</p>
<p style="text-align:right;">Alfred Korzybski</p>
</blockquote>
<p style="text-align:justify;">Meaning that <strong>these are just 
guidelines! The application is the territory, the reality, the concrete 
use case where we need to apply our knowledge, and that is what will 
define what the actual architecture will look like!</strong></p>
<p style="text-align:justify;"><strong>We need to understand all these 
patterns, but we also always need to think and understand exactly what 
our application needs, how far should we go for the sake decoupling and 
cohesiveness.</strong> This decision can depend on plenty of factors, 
starting with the project functional requirements, but can also include 
factors like the time-frame to build the application, the lifespan of 
the application, the experience of the development team, and so on.</p>
<p style="text-align:justify;">This is it, this is how I make sense of it all. This is how I rationalize it in my head.</p>
<p style="text-align:justify;">However, how do we make all this explicit
 in the code base? That’s the subject of my next post about how I 
reflect the architecture and domain, in the code.</p>
<p style="text-align:justify;">Last but not least, thanks to my colleague&nbsp;<a href="https://www.linkedin.com/in/francescomastrogiacomo/" target="_blank" rel="noopener">Francesco Mastrogiacomo</a>, for helping me make my infographic look nice. <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
		<div class="wpcnt">
			<div class="wpa wpmrec" style="display: inline-block !important;">
				<span class="wpa-about">Advertisements</span>
				<div class="u">		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-right:5px;margin-top:0px">
		<div id="atatags-26942" style="overflow: hidden; position: relative; width: auto; height: auto;"><div style="width: 300px; height: 250px;"><iframe scrolling="no" style="border:none;overflow:hidden;width:300px;height:250px;" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe></div><div id="atatags-26942__controls" style="width:300px;height:10px;text-align:right;line-height:6px;"><span id="atatags-26942__complain-btn" style="font-size: 10px; color: rgb(109, 171, 210); text-decoration: underline; cursor: pointer; display: inline;">Report this ad</span></div></div></div>		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-top:0px">
		<div id="atatags-114160" style="overflow: hidden; position: relative; width: auto; height: auto;"><div style="width: 300px; height: 250px;"><iframe scrolling="no" style="border:none;overflow:hidden;width:300px;height:250px;" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe><iframe scrolling="no" style="width:0px;height:0px;border:none;" tabindex="-1" width="300" height="250" frameborder="0"></iframe></div><div id="atatags-114160__controls" style="width:300px;height:10px;text-align:right;line-height:6px;"><span id="atatags-114160__complain-btn" style="font-size: 10px; color: rgb(109, 171, 210); text-decoration: underline; cursor: pointer; display: inline;">Report this ad</span></div></div></div></div>
						<div id="crt-1049670804" style="width: 300px; height: 250px; display: none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-1049670804");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-1049670804",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>		<div id="crt-771652688" style="width: 300px; height: 250px; display: none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-771652688");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:837497,containerid:"crt-771652688",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-14874" class="share-twitter sd-button share-icon" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-14874" class="share-facebook sd-button share-icon" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?share=facebook&amp;nb=1" target="_blank" title="Share on Facebook"><span>Facebook<span class="share-count">311</span></span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-14874" class="share-google-plus-1 sd-button share-icon" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-98044927-14874-5a632dfebdde2" data-src="//widgets.wp.com/likes/#blog_id=98044927&amp;post_id=14874&amp;origin=herbertograca.wordpress.com&amp;obj_id=98044927-14874-5a632dfebdde2" data-name="like-post-frame-98044927-14874-5a632dfebdde2"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-98044927-14874-5a632dfebdde2" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_014.html" width="100%" height="55px" frameborder="0"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="10113" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://herbertograca.com/2017/07/03/the-software-architecture-chronicles/" title="The Software Architecture Chronicles

This post&nbsp;is the first of a series of posts about Software Architecture. In them, I write about what I've learned on Software Architecture, how I think of it, and how I use that knowledge." rel="nofollow" data-origin="14874" data-position="0">The Software Architecture Chronicles</a></span><span class="jp-relatedposts-post-context">In "Architecture"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="8825" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://herbertograca.com/2017/09/28/clean-architecture-standing-on-the-shoulders-of-giants/" title="Clean Architecture: Standing on the shoulders of giants

Robert C. Martin (AKA Uncle Bob) published his ideas about Clean Architecture&nbsp;back in 2012, in a post on his blog, and lectured about it at a few conferences. The Clean Architecture leverages well-known and not so well-known&nbsp;concepts, rules, and patterns, explaining how to fit them together, to propose a standardised…" rel="nofollow" data-origin="14874" data-position="1">Clean Architecture: Standing on the shoulders of giants</a></span><span class="jp-relatedposts-post-context">In "Architecture"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="5622" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://herbertograca.com/2017/07/05/software-architecture-premises/" title="Software Architecture Premises

In this post, I establish the very first concepts about Software Architecture, that will be needed in order to better understand the following posts." rel="nofollow" data-origin="14874" data-position="2">Software Architecture Premises</a></span><span class="jp-relatedposts-post-context">In "Architecture"</span></p></div></div></div>	</div><!-- .entry-content -->

	<div class="entry-footer">
		<ul class="post-tags light-text"><li>Tagged</li><li><a href="https://herbertograca.com/tag/architecture-2/" rel="tag">architecture</a></li><li><a href="https://herbertograca.com/tag/explicit-architecture/" rel="tag">explicit architecture</a></li><li><a href="https://herbertograca.com/tag/software-architecture/" rel="tag">software architecture</a></li><li><a href="https://herbertograca.com/tag/software-development/" rel="tag">software development</a></li></ul><!-- .post-tags -->	</div><!-- .entry-footer -->

	<div class="entry-author-wrapper">
			<div class="entry-author author-avatar-show">
				<div class="author-avatar">
			<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a.jpeg" class="avatar avatar-80 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-0" width="80" height="80">		</div><!-- .author-avatar -->
		
		<div class="author-heading">
			<h2 class="author-title">Published by <span class="author-name">hgraca</span></h2>
		</div><!-- .author-heading -->

		<p class="author-bio">
						<a class="author-link" href="https://herbertograca.com/author/hgraca/" rel="author">
				View all posts by hgraca			</a>
		</p><!-- .author-bio -->
	</div><!-- .entry-auhtor -->
		<div class="site-posted-on">
			<strong>Published</strong>
			<time class="entry-date published" datetime="2017-11-16T15:30:54+00:00">November 16, 2017</time><time class="updated" datetime="2017-12-02T13:01:18+00:00">December 2, 2017</time>		</div><!-- .site-posted-on -->
	</div>
</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://herbertograca.com/2017/11/09/service-oriented-architecture-soa/" rel="prev"><span class="meta-nav screen-reader-text">Previous Post</span> Service Oriented Architecture&nbsp;(SOA)</a></div></div>
	</nav>
			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			44 thoughts on “<span>DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all&nbsp;together</span>”		</h2><!-- .comments-title -->

		
		<ol class="comment-list">
					<li id="comment-649" class="pingback even thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://herbertograca.com/2017/07/03/the-software-architecture-chronicles/" rel="external nofollow" class="url">The Software Architecture Chronicles – @herbertograca</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-650" class="comment byuser comment-author-thedilab odd alt thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-650" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/5385a63fb63aa282d92c929fa27df283.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-5385a63fb63aa282d92c929fa27df283-0" width="48" height="48">						<b class="fn">thedilab</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-650">
							<time datetime="2017-11-17T02:43:46+00:00">
								November 17, 2017 at 02:43							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Have you ever implemented such patterns in any projects?</p>
<p id="comment-like-650" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=650&amp;_wpnonce=b202dc7b67" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-650" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=650#respond" onclick='return addComment.moveForm( "div-comment-650", "650", "respond", "14874" )' aria-label="Reply to thedilab">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-651" class="comment byuser comment-author-hgraca bypostauthor even depth-2 parent highlander-comment">
			<article id="div-comment-651" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-1" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-651">
							<time datetime="2017-11-17T07:13:39+00:00">
								November 17, 2017 at 07:13							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yes, I have.<br>
In big enterprise projects, for example one is a SaaS ecom platform with
 thousands of web-shops worldwide, another one is a marketplace, live in
 2 countries with a message bus thats handles over 20 million messages 
per month.</p>
<p id="comment-like-651" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=651&amp;_wpnonce=d3ec10d90f" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-651" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=651#respond" onclick='return addComment.moveForm( "div-comment-651", "651", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-652" class="comment byuser comment-author-thedilab odd alt depth-3 highlander-comment">
			<article id="div-comment-652" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/5385a63fb63aa282d92c929fa27df283.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-5385a63fb63aa282d92c929fa27df283-1" width="48" height="48">						<b class="fn">thedilab</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-652">
							<time datetime="2017-11-17T07:59:33+00:00">
								November 17, 2017 at 07:59							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sounds awesome!</p>
<p>Regards,<br>
Xu</p>
<p id="comment-like-652" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=652&amp;_wpnonce=8e7d965f6c" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-652" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-654" class="comment byuser comment-author-ngocviet even thread-even depth-1 parent highlander-comment">
			<article id="div-comment-654" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/5cfb78328c3542047d6cb4014507f34f.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-5cfb78328c3542047d6cb4014507f34f-0" width="48" height="48">						<b class="fn">tnviet</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-654">
							<time datetime="2017-11-17T10:33:45+00:00">
								November 17, 2017 at 10:33							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for your articles, I understand more about the patterns now.<br>
But it seems all the backend patterns. How the frontend fit on the 
architecture? For example, in the single page application (React, 
Angular, …)  where we have components with their own business logic 
(like validation, hide/show field based on properties? Should the UI 
have their own domain model/services?</p>
<p id="comment-like-654" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=654&amp;_wpnonce=fc1e9377da" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-654" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=654#respond" onclick='return addComment.moveForm( "div-comment-654", "654", "respond", "14874" )' aria-label="Reply to tnviet">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-664" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-664" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-2" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-664">
							<time datetime="2017-11-18T16:44:35+00:00">
								November 18, 2017 at 16:44							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Well, I’m not a frontender, but I feel these concepts are quite generic and usable in the frontend as well.<br>
Just the other day I was discussing with the react native developer 
working with me and we decided to create an adapter for the backend API 
his application is using because if we need to switch to another API 
version he can easily create another adapter and have it working.</p>
<p>When it comes to the domain in the frontend, it depends. If it really
 is just a frontend app with no backend and domain logic, then we can 
create a domain model as well. But in a very small app, I don’t know if 
it is worth it, I can only judge case by case, we can not go into the 
hammer and nail approach.</p>
<p>As for “validation, hide/show field based on properties”, those are 
not domain concerns, those are just functionality used by the frontend. I
 would even regard them as language constructs that can just be used 
wherever. For example, PHP does not have a native function to create a 
Uuid, but it is a very innocuous thing, so I would just create a 
function to generate them and treat it as if it was part of the PHP core
 itself. At any point I could just change its implementation to use Uuid
 v3 or v4, or whatever.</p>
<p>I hope this helps, although as I said, I have no experience in frontend.</p>
<p id="comment-like-664" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=664&amp;_wpnonce=61e271db04" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-664" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=664#respond" onclick='return addComment.moveForm( "div-comment-664", "664", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-657" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-657" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/0305d7bb35aba50c6ca8448965a8f95e.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-0305d7bb35aba50c6ca8448965a8f95e-0" width="48" height="48">						<b class="fn">Patrick Roza</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-657">
							<time datetime="2017-11-17T15:41:20+00:00">
								November 17, 2017 at 15:41							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Love your post. Excellent reference material for some active topics for me.</p>
<p>This is how I’ve been architecting software projects for the past few years and I’ve been extremely happy with the results:<br>
– Clean<br>
– Extendable<br>
– Flexible<br>
– Predictable<br>
– Scalable</p>
<p>At danger of treading into “Hammer &amp; Nail” territory, I found 
this can be applied to pretty much every type of project, be it Desktop 
UI, Console, Web App, API, regardless of delivery mechanism, you name 
it. and virtually any programming language and framework.</p>
<p>I never liked how frameworks and libraries would take over your 
project structure and dependencies, as well as infiltrate your lingo and
 dictating your choices.<br>
But with this approach it has become just a detail, sitting at the outside boundary of your app.</p>
<p id="comment-like-657" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=657&amp;_wpnonce=1af7bfbb81" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-657" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=657#respond" onclick='return addComment.moveForm( "div-comment-657", "657", "respond", "14874" )' aria-label="Reply to Patrick Roza">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-658" class="comment byuser comment-author-rclanan odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-658" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/4fdaf861a4e2146ef4d2cac924453029.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-4fdaf861a4e2146ef4d2cac924453029-0" width="48" height="48">						<b class="fn"><a href="https://utopianconcept.com/" rel="external nofollow" class="url">Ray Clanan</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-658">
							<time datetime="2017-11-17T19:33:40+00:00">
								November 17, 2017 at 19:33							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great article, I can’t wait to read more from you.</p>
<p id="comment-like-658" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=658&amp;_wpnonce=c9dbe71d37" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-658" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=658#respond" onclick='return addComment.moveForm( "div-comment-658", "658", "respond", "14874" )' aria-label="Reply to Ray Clanan">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-659" class="pingback even thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://lessthan12ms.com/clean-architecture-links/" rel="external nofollow" class="url">Clean architecture links | lessthan12ms.com</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-660" class="comment odd alt thread-even depth-1 parent highlander-comment">
			<article id="div-comment-660" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/91717ad94f01b6be1e63111f23e3660c.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-91717ad94f01b6be1e63111f23e3660c-0" width="48" height="48">						<b class="fn"><a href="https://lessthan12ms.com/" rel="external nofollow" class="url">Dmitriy</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-660">
							<time datetime="2017-11-18T11:18:54+00:00">
								November 18, 2017 at 11:18							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Wow, that is an article! Thanks for putting such a huge amount of work to compose it.<br>
I have a lot of questions about proper architecture but the most 
struggling one which is bothering me in my work is authorization.</p>
<p>Would you mind to put some light on how you’d design authorization 
across all the layers and components? You mentioned that component 
itself can be of the purpose of authorization. How does it all work 
together?</p>
<p id="comment-like-660" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=660&amp;_wpnonce=6612c4717b" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-660" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=660#respond" onclick='return addComment.moveForm( "div-comment-660", "660", "respond", "14874" )' aria-label="Reply to Dmitriy">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-663" class="comment byuser comment-author-hgraca bypostauthor even depth-2 parent highlander-comment">
			<article id="div-comment-663" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-3" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-663">
							<time datetime="2017-11-18T16:25:16+00:00">
								November 18, 2017 at 16:25							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Tkx. <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p>I would use an ACL module. I would try to find an ACL module, a tool,
 that I could just create an adapter for it and protect the routes 
according to what user is logged in, and some configuration files 
specifying what type of user has access to each route.<br>
I think Authorization and Authentication were not a good example, it’s a
 flop, sorry. The Components should be Domain related, they are 
BoundedContexts, and Authorization and Authentication are not domain. I 
will replace those examples immediately.</p>
<p id="comment-like-663" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=663&amp;_wpnonce=6d849fe112" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-663" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=663#respond" onclick='return addComment.moveForm( "div-comment-663", "663", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-670" class="comment odd alt depth-3 highlander-comment">
			<article id="div-comment-670" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ae9d562f99b12dba78ea4fafa5d76ef4.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-ae9d562f99b12dba78ea4fafa5d76ef4-0" width="48" height="48">						<b class="fn">Peter</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-670">
							<time datetime="2017-11-19T17:45:29+00:00">
								November 19, 2017 at 17:45							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I think you need to make the distinction between authorising and
 authenticating (making sure this person is who clam to be and that he 
can actually access the part of the application he is trying to access) 
and managing you authentication and authorization (user registration, 
user login, managing user roles, …)</p>
<p>The latter can be seen as a (sub)domain of your application. However 
this is usually pretty generic and you can easily use an existing 
component to handle all of it, because why spend precious time 
reinventing and redesigning the wheel. Unless you have very specific 
needs which you can’t find in the existing components.</p>
<p>The former is in my opinion a concern of your (driving) adapter. It 
is (usually) not your application logic that should check wether the 
user is logged in, or has access to this specific command. It is the 
duty of your web controller (or even web framework) to handle this. I 
see it this way, because depending on where the request comes from, your
 access rules may vary. For example, when using the CLI, you could 
assume the user doesn’t need to be logged in, as he is an admin of your 
system. Or you may want some functionality to be accessible not only to a
 person logged in to your system, but also to someone logged in into an 
external admin system (like someone from a helpdesk who can edit a users
 account).</p>
<p>Sometimes it might seem to be a domain rule that some things can only
 be altered by the user who created this thing, but more often then not,
 this business rule doesn’t hold up when you start thinking about the 
part of the system, which can not be seen be a regular user.</p>
<p id="comment-like-670" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=670&amp;_wpnonce=e450955dc6" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-670" class="comment-like-feedback">Liked by <a href="#" class="view-likers" data-like-count="1">1 person</a></span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-676" class="comment even depth-3 parent highlander-comment">
			<article id="div-comment-676" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/91717ad94f01b6be1e63111f23e3660c.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-91717ad94f01b6be1e63111f23e3660c-1" width="48" height="48">						<b class="fn"><a href="https://lessthan12ms.com/" rel="external nofollow" class="url">Dmitriy</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-676">
							<time datetime="2017-11-20T12:13:41+00:00">
								November 20, 2017 at 12:13							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I can’t find a place in my head for a proper authorization 
model. While ACL is a good separation (if I understand it correctly) – 
like if you have some particular role attached to you, then you can post
 to a blog, if don’t then you cant.</p>
<p>In my practice, there were more complex rules which transcend layers 
(app and domain layers.). You might need a specific role to make a 
domain action but also you need to meet some specific domain criteria.</p>
<p>For example, “You can post a comment if you have a “client” role AND 
you’ve purchased this product in the past”. This kind of rules involves 
specific domain logic to be executed.</p>
<p>So when you saying that “Authorization and Authentication are not 
domain”, I kind of disagree about authorization. Because Authorization 
can involve domain rules. Right?</p>
<p>I really want to learn effective ways to organize authorization logic
 in clean architecture. While I do understand all this 
layer&amp;ports&amp;adapters paradigm I feel like authorization part is 
often left undisclosed in many blog posts and books.</p>
<p>—<br>
p.s. I haven’t read the latest Uncle Bob’s book on the subject. Perhaps there are some hints about authorization.</p>
<p id="comment-like-676" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=676&amp;_wpnonce=ca3dfd3125" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-676" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-705" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-3 highlander-comment">
			<article id="div-comment-705" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-4" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-705">
							<time datetime="2017-12-01T13:32:12+00:00">
								December 1, 2017 at 13:32							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sorry, I’ve missed your comment last week.</p>
<p>But to answer you, what you are talking about is not exactly Authorization in terms that I was talking about.<br>
I was referring to Authorization in the sense of “Who can access what” 
platform-wide, which is basically a configuration that is set up in some
 config file, although to make it scalable we should use a generic ACL 
component.</p>
<p>What you are referring to is indeed business rules, not authorization in the sense of a platform-wide set of rules.<br>
So those business rules do not belong in a generic Authorization component, it belongs in the component that needs it.</p>
<p>Going back to your example “You can post a comment if you have a 
‘client’ role AND you’ve purchased this product in the past”, we only 
need this when the consumer issues a command to post a comment.<br>
So, the way I see it, this is a specific rule for this specific use case
 (ie. “CreateProductComment”), of a specific component (ie. 
“ReviewComponent”).<br>
We need to validate this rule but it is very specific.<br>
Doing it quick and dirty, we can simply put an if statement in the command handler (or application service method).<br>
Doing it a bit more scalable, we can create an authorization service 
specific to this component which will contain all the validation rules 
for all commands in the component.<br>
Doing it a bit better, we could have a configuration setup saying that a
 use case (command, or application service method) prior to running 
needs to be validated with some other class/method.<br>
If we are using a Command Bus, this would be something that could be done there, with a validation middleware.<br>
Depending on our concrete needs, we could also use a Specification 
pattern where we would put fine-grained business rules, in such a way 
that we could eventually create complex business rules in specification 
objects by composing them from other specification objects.</p>
<p>In any case, both the use case code and its validation rules belong 
together, in the same component, and it is not what is generally 
referred to as Authorization.</p>
<p id="comment-like-705" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=705&amp;_wpnonce=33f10f67a6" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-705" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-711" class="comment even depth-3 parent highlander-comment">
			<article id="div-comment-711" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/91717ad94f01b6be1e63111f23e3660c.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-91717ad94f01b6be1e63111f23e3660c-2" width="48" height="48">						<b class="fn"><a href="https://lessthan12ms.com/" rel="external nofollow" class="url">Dmitriy</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-711">
							<time datetime="2017-12-03T07:35:19+00:00">
								December 3, 2017 at 07:35							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>(I was not able to reply directly to the message you’ve replied to me with. Maybe the blog reached maximum comment depth)</p>
<p>Authorization</p>
<p>I see you separate the two: generic ACL authorization and business 
rules. It makes total sense to me to have a separated authorizer class 
attached to a command handler. In fact, I practiced it and it worked 
very well.</p>
<p>So to follow your logic, generic ACL lets administrator to manually 
assign roles to users and allow roles to perform certain actions. Once a
 user is allowed to make a command only then domain rules will perform 
additional validation against the command and maybe reject it due to 
some unmet restrictions. It is like a 2-level authorization.</p>
<p>Performance</p>
<p>I was recently asked on my blog (<a href="https://lessthan12ms.com/authorization-and-authentication-in-clean-architecture/#comment-3629170994" rel="nofollow">https://lessthan12ms.com/authorization-and-authentication-in-clean-architecture/#comment-3629170994</a>)
 how to deal with performance and code separation. For example, an 
authorizer class and command handler both can query the same data to 
make the work. But since they are independent, we may end up with 
multiple database queries.</p>
<p>How do you design such things in your apps? Can you give some guidance on improving performance in “clean architecture” apps?</p>
<p id="comment-like-711" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=711&amp;_wpnonce=080d4cad1a" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-711" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-712" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-3 highlander-comment">
			<article id="div-comment-712" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-5" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-712">
							<time datetime="2017-12-03T09:42:30+00:00">
								December 3, 2017 at 09:42							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Glad my explanation helped you <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p>About the performance related to repeating queries in different 
contexts of the application, I think the Application Core should not 
concern itself with it. I think that is something for the ORM to deal 
with.</p>
<p>Doctrine, for example, uses a 1st level cache that stores the objects
 that were already fetched from the DB. It also keeps track of what 
queries were executed and what objects they returned. This 1st level 
cache is up during the request and only in the end it flushes all 
changes to the DB. So it takes care of repeating queries.</p>
<p>Doctrine also has a 2nd level cache where it stores objects in redis and reuses that cache through several requests.</p>
<p>Nevertheless, what I think we need to be very careful with is the N+1
 problem when we create our queries. There is not much the ORM can do to
 help us with that except for telling us that a query is being repeated.</p>
<p id="comment-like-712" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=712&amp;_wpnonce=9cf0ce1b6a" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-712" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-661" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-661" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/cbec86946b25a1679fceb265fd54d1ce.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-cbec86946b25a1679fceb265fd54d1ce-0" width="48" height="48">						<b class="fn"><a href="http://spj.com.pl/" rel="external nofollow" class="url">Tomasz Sadza</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-661">
							<time datetime="2017-11-18T11:47:31+00:00">
								November 18, 2017 at 11:47							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, may I ask about final infographic in scalable version 
(vector pdf or svg) to printout on the wall in my developers office ? 
It’s very good and I think I may be usefull many times. Thank you</p>
<p id="comment-like-661" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=661&amp;_wpnonce=b8fd5cf06f" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-661" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=661#respond" onclick='return addComment.moveForm( "div-comment-661", "661", "respond", "14874" )' aria-label="Reply to Tomasz Sadza">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-662" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-662" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-6" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-662">
							<time datetime="2017-11-18T16:13:06+00:00">
								November 18, 2017 at 16:13							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Sure, here you go: <a href="https://drive.google.com/open?id=1E_hx5B4czRVFVhGJbrbPDlb_JFxJC8fYB86OMzZuAhg" rel="nofollow">https://drive.google.com/open?id=1E_hx5B4czRVFVhGJbrbPDlb_JFxJC8fYB86OMzZuAhg</a></p>
<p id="comment-like-662" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=662&amp;_wpnonce=840924be66" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-662" class="comment-like-feedback">Liked by <a href="#" class="view-likers" data-like-count="1">1 person</a></span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=662#respond" onclick='return addComment.moveForm( "div-comment-662", "662", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-665" class="comment byuser comment-author-alyaros even thread-even depth-1 parent highlander-comment">
			<article id="div-comment-665" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/378eefea3af018ef9279ad59fbc0bfff.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-378eefea3af018ef9279ad59fbc0bfff-0" width="48" height="48">						<b class="fn"><a href="http://onetechaday.wordpress.com/" rel="external nofollow" class="url">alyaros</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-665">
							<time datetime="2017-11-18T17:14:10+00:00">
								November 18, 2017 at 17:14							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>First I would like to say that this is a very good summary of 
all the concepts (DDD, CQRS, P&amp;A etc…) into one coherent whole 
solution and also to take the opportunity and say that I really enjoy 
reading your blog posts.<br>
I’m familiar with the ideas mentioned in the post for several years now 
and also I’ve been following those topics in various places: blogs, 
books, conferences and more and also tested\implemented some of them 
myself in various projects to some extent.<br>
There 2 main issues that bother me the most regarding this and I’ll be very happy to hear your opinion.<br>
1)  Creating many abstraction and separations (Domain objects, Domain 
services, App services, DTO’s , Persistence adapters  etc.. ) is adding a
 lot of entities to maintain and also many mappers between them – this 
creates A lot of boilerplate code that is hard to maintain. For example I
 have at the minimum 3 flavors of the same entity – one for the primary 
adapters (i.e. return User to the UI\service-client), second for the 
domain, third for the persistence adapter. (Usually it’s simple 1:1 
mapping but obviously not always)</p>
<p>2)  Such abstractions creates significant performance penalty mainly 
on data driven applications. For example let’s look on the separation 
between domain and persistence. We aspire to keep the business code 
isolated inside the domain and treating the persistence as storage 
mechanism – we can save or getBy (filter) but we try to keep the 
business decision\logic inside the domain – doing so can lead to a very 
inefficient usage of the persistence (I.e. DB) – for example instead of 
creating a more complex query that will do some of the calculation on 
the DB itself we fetch a lot of data, translate it to domain, perform 
the calculation and return the result. The question is how you prevent 
leakage of business rules into the persistence adapter while still 
keeping the process efficient as possible.</p>
<p id="comment-like-665" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=665&amp;_wpnonce=02504cf8ee" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-665" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=665#respond" onclick='return addComment.moveForm( "div-comment-665", "665", "respond", "14874" )' aria-label="Reply to alyaros">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-671" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-671" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-7" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-671">
							<time datetime="2017-11-19T23:12:41+00:00">
								November 19, 2017 at 23:12							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,</p>
<p>Thank you, I’m glad you have been enjoying my posts. <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p>Regarding your questions:</p>
<p>1) Yes, you are absolutely right. Doing all this creates more code.<br>
However, I don’t think it has high maintainability costs as once it is 
done, it just sits there. If we need to change it, it’s better to change
 in that one place, as opposed to everywhere where the actual tool would
 be explicitly used. But on the other hand, it does give us the 
advantage of easily changing how we handle the actual tool behind the 
port/adapter.<br>
For example, at my current company we had an adapter for the symfony 
event dispatcher and all our core only knew about the interface in front
 of the adapter. When we decided to start using async events, we just 
had to create the adapter for the async events and add it to the list of
 adapters being used by the actual dispatcher being used in our 
application.<br>
The same thing goes for the cases where we want to upgrade some library 
version. If we have an adapter, we just need to write a new adapter, the
 application core will stay the same.<br>
These practices give a lot of stability to the application core.<br>
Nevertheless, Software Architecture is all about tradeoffs. So, if the 
project at hand is not going to be long-lived, or the company is still 
in a stage of lean-startup, and creating these ports/adapters will be 
too time-consuming, maybe it’s better to just use the tools directly 
throughout the codebase. Also keep in mind that there are ports/adapters
 easier to create than others, so maybe we can create the ones that are 
easier to create and not the most difficult ones.<br>
In the end, it’s all about tradeoffs. The important is that we know all 
these patterns, because they can help us at some point, but we use only 
what is worth using in a specific context.</p>
<p>2) Picking up your example “for example instead of creating a more 
complex query that will do some of the calculation on the DB itself we 
fetch a lot of data, translate it to domain, perform the calculation and
 return the result. The question is how you prevent leakage of business 
rules into the persistence adapter while still keeping the process 
efficient as possible.”<br>
I think that the actual domain is the fact that we use the result of 
that specific calculation, not the way we actually calculate it. So, I 
would create a query object with a class name and method name that 
accurately reflects the calculation being made from the domain point of 
view, and have the DB make that calculation for me and just return the 
result. Since we only want to get data, we dont need to use an ORM to 
hydrate the data into entities. We only need to hydrate entities if we 
want them to “do” something, as opposed to just give use some data to 
show our users.<br>
I use query objects when I just want to get data. A query object only has one query inside.<br>
I use repositories pretty much as collections. A repository always returns an entity or set of entities.</p>
<p>I hope this helps.</p>
<p id="comment-like-671" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=671&amp;_wpnonce=80007ed095" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-671" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=671#respond" onclick='return addComment.moveForm( "div-comment-671", "671", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-783" class="comment even depth-3 parent highlander-comment">
			<article id="div-comment-783" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/625bfdcc5ebe17f847a1de7f6ce4c0a0.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-625bfdcc5ebe17f847a1de7f6ce4c0a0-0" width="48" height="48">						<b class="fn">Oleksandr Sova</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-783">
							<time datetime="2017-12-30T03:24:15+00:00">
								December 30, 2017 at 03:24							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you for your great post/article. Wish to have it couple 
years earlier. Everything described amazing but still have one question:
 at previous comment you told about that when you do a Query and you 
only need the data you do it avoiding ORM and other stuff. That is a way
 that I usually do. For instance I have a controller that depends on, 
lets say <i> LastMonthDeposits – contract of a query, which is 
implemented by LastMonthDepositsPostgreSQL which depends DIRECTLY on 
connection. And at schema your query depends on contract of persistence 
which is implemented by persistence adapter which depends on whole ORM 
and so on. So why would anyone choose to go all the way down through ORM
 instead of be specific? And in terms of PHP – why would anyone use 
adapter over doctrine/orm instead of direct doctrine/dbal (query level 
cache is it’s responsibility) in case of Query, not Command handling?</i></p><i>
<p>Yes, I have read that it’s just a guideline and so on but the main 
thing that I’d like to know is what were the preconditions/circumstances
 to emit such particular guideline?</p>
<p id="comment-like-783" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=783&amp;_wpnonce=04005e5d56" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-783" class="comment-like-feedback">Like</span></p>
</i><p><i></i></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-786" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-3 highlander-comment">
			<article id="div-comment-786" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-8" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-786">
							<time datetime="2017-12-30T13:26:46+00:00">
								December 30, 2017 at 13:26							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, tkx.</p>
<p>If I understand correctly, your question is “Why does the query 
object implementation depend on the persistence port, whose 
implementation uses the ORM/DBAL, instead of the connection directly?”</p>
<p>There are 2 things I wanna point out to answer your question:</p>
<p>1.<br>
The reason is the same as usual, by making the query object 
implementation depend on the port, we can change or completely swap the 
persistence implementation without changing the query object 
implementation (as long as the query language is the same). For example,
 if we use a port/adapter we can add a line of code to the adapter to 
log all queries being made. In the other hand, if we inject the 
connection in all our query objects, to add the same logging we will 
have to add that line of code to all the query objects and inject that 
logger into all of those objects.</p>
<p>2.<br>
The implementation of the persistence port does not need to be the same.
 So, for commands, you can use an implementation (adapter) that wraps 
around the ORM but, for the query objects, you can use an implementation
 that wraps around the DBAL, or the connection itself. This way, you can
 skip the ORM and/or DBAL overhead when you don’t need it and still have
 the flexibility that the port/adapter brings us.</p>
<p>Did this answer your question?</p>
<p id="comment-like-786" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=786&amp;_wpnonce=30e3dae154" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-786" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-669" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-669" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/98442eeeeb11844d9992d93562f892ce.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-98442eeeeb11844d9992d93562f892ce-0" width="48" height="48">						<b class="fn"><a href="http://gravatar.com/stephanerondalarexo" rel="external nofollow" class="url">Stephane</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-669">
							<time datetime="2017-11-19T13:48:40+00:00">
								November 19, 2017 at 13:48							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for the article.<br>
Great subject.<br>
Would you be willing to present that at Wajug user group (in belgium)?<br>
We’re looking for great speakers and great subjects.<br>
Have a look at our upcoming/past events:<br>
<a href="http://www.wajug.be/" rel="nofollow">http://www.wajug.be/</a><br>
<a href="http://www.wajug.be/pastEvents" rel="nofollow">http://www.wajug.be/pastEvents</a></p>
<p>Hope to hear from you,<br>
Stephane</p>
<p id="comment-like-669" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=669&amp;_wpnonce=1dbb6916ce" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-669" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=669#respond" onclick='return addComment.moveForm( "div-comment-669", "669", "respond", "14874" )' aria-label="Reply to Stephane">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-673" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-673" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-9" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-673">
							<time datetime="2017-11-19T23:22:06+00:00">
								November 19, 2017 at 23:22							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you!</p>
<p>I feel flattered now!! <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"><br>
Liege is a bit out of my way though…<br>
But I still wanna write a few more posts and then if I decide to make some talks I will send you guys an email.</p>
<p>Thank you for the invite, I really appreciate it.</p>
<p id="comment-like-673" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=673&amp;_wpnonce=137d19e898" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-673" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=673#respond" onclick='return addComment.moveForm( "div-comment-673", "673", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-675" class="comment even depth-3 highlander-comment">
			<article id="div-comment-675" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/98442eeeeb11844d9992d93562f892ce.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-98442eeeeb11844d9992d93562f892ce-1" width="48" height="48">						<b class="fn">Stephane Rondal</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-675">
							<time datetime="2017-11-20T09:15:18+00:00">
								November 20, 2017 at 09:15							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You’re welcome, I really liked your post.<br>
No problem, contact me when you’re ready for some talks.<br>
It will be a pleasure to host you.<br>
And Liege is not that far from Amsterdam <img draggable="false" class="emoji" alt="😉" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f609.svg"><br>
In the meantime, good continuation with your excellent articles.</p>
<p>Cheers,<br>
Stephane</p>
<p id="comment-like-675" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=675&amp;_wpnonce=a4264c699f" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-675" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-679" class="comment byuser comment-author-pnghai odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-679" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/349d44c089cf2ec5f1c800f158fa2458.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-349d44c089cf2ec5f1c800f158fa2458-0" width="48" height="48">						<b class="fn">pnghai</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-679">
							<time datetime="2017-11-21T10:27:48+00:00">
								November 21, 2017 at 10:27							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Reblogged this on <a href="https://haiphanit.wordpress.com/2017/11/21/ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/" rel="nofollow">Pikachu's Corner</a>.</p>
<p id="comment-like-679" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=679&amp;_wpnonce=a034ac7d4d" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-679" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=679#respond" onclick='return addComment.moveForm( "div-comment-679", "679", "respond", "14874" )' aria-label="Reply to pnghai">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-704" class="pingback even thread-odd thread-alt depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://jesperjarlskov.dk/november-2017-php/" rel="external nofollow" class="url">November-2017.php – Jesper Jarlskov's blog</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-714" class="comment odd alt thread-even depth-1 highlander-comment">
			<article id="div-comment-714" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/NYsigyB8_normal.jpg" class="avatar avatar-48" width="48" height="48">						<b class="fn"><a href="http://twitter.com/tlfbrito" rel="external nofollow" class="url">Tiago Brito (@tlfbrito)</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-714">
							<time datetime="2017-12-05T00:55:31+00:00">
								December 5, 2017 at 00:55							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for this article. Very detailed.</p>
<p id="comment-like-714" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=714&amp;_wpnonce=e93ff2477f" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-714" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=714#respond" onclick='return addComment.moveForm( "div-comment-714", "714", "respond", "14874" )' aria-label="Reply to Tiago Brito (@tlfbrito)">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-732" class="comment even thread-odd thread-alt depth-1 highlander-comment">
			<article id="div-comment-732" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/4763b4d6e4b51ca8fb4dbf4620f71d81.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-4763b4d6e4b51ca8fb4dbf4620f71d81-0" width="48" height="48">						<b class="fn"><a href="http://radblog.pl/" rel="external nofollow" class="url">Radek Maziarka</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-732">
							<time datetime="2017-12-12T23:25:38+00:00">
								December 12, 2017 at 23:25							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I am amazed by this post. Great work <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p id="comment-like-732" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=732&amp;_wpnonce=189fdeb6f2" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-732" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=732#respond" onclick='return addComment.moveForm( "div-comment-732", "732", "respond", "14874" )' aria-label="Reply to Radek Maziarka">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-738" class="pingback odd alt thread-even depth-1 highlander-comment">
			<div class="comment-body">
				Pingback: <a href="https://edwardthienhoang.wordpress.com/2017/12/13/ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/" rel="external nofollow" class="url">DDD, Hexagonal, Onion, Clean, CQRS, … How I put it all together – Java Việt Nam</a> 			</div>
</li><!-- #comment-## -->
		<li id="comment-750" class="comment even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-750" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-0" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-750">
							<time datetime="2017-12-19T01:34:51+00:00">
								December 19, 2017 at 01:34							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello. Great post. Congratulations.</p>
<p>How do you deal with secondary ports and components?</p>
<p>Do you consider a port being part of the component, or is the port a separate layer?</p>
<p>For example, if each component owns its repository the secondary 
adapter should depends on all components (the whole app core, not just 
the ports).</p>
<p>But if you put ports in a separate layer, the you break package by component design.</p>
<p>Thanks, Juan.</p>
<p id="comment-like-750" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=750&amp;_wpnonce=f0f97e9434" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-750" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=750#respond" onclick='return addComment.moveForm( "div-comment-750", "750", "respond", "14874" )' aria-label="Reply to Juan">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-752" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-752" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-10" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-752">
							<time datetime="2017-12-19T11:23:44+00:00">
								December 19, 2017 at 11:23							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Tkx for your nice words, I appreciate it. <img draggable="false" class="emoji" alt="☺" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/263a.svg"></p>
<p>As for your question, I don’t understand what you mean by ‘secondary ports and components’. But maybe this will make it clear:</p>
<p>If my application uses an ORM, I will create a Persistence port and 
an adapter for the ORM. That port will be used by all components that 
need the ORM. The ports belong to the application core, its an 
entry/exit point to the application core, not to a specific component.</p>
<p>Repositories are specific to a component, si I place them in its 
specific component. They depend on the ORM port, it is injected in the 
repository constructor.<br>
The tricky thing with repositories is that they are also specific to the
 query language. They implement a repository interface, but then there 
can be different implementations per query language. A query language 
depends on the persistence engine used, it can be SQL, Mongo Query 
Language, Elasticsearch query language, Doctrine Query Language, … 
whatever.<br>
This means that a repository, although not an adapter around the ORM, it
 is an adapter for the query language, and it might need to know some 
specifics about what is outside the Application Core, it definitely 
needs to know what language it is using, and if using DQL it needs the 
doctrine query builder to be injected. Unless we create our own query 
language, like Doctrine did, but I think that is going way too far.</p>
<p>Did this answer your question?</p>
<p id="comment-like-752" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=752&amp;_wpnonce=bf43ea8314" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-752" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=752#respond" onclick='return addComment.moveForm( "div-comment-752", "752", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-784" class="comment even depth-2 parent highlander-comment">
			<article id="div-comment-784" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/625bfdcc5ebe17f847a1de7f6ce4c0a0.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-625bfdcc5ebe17f847a1de7f6ce4c0a0-1" width="48" height="48">						<b class="fn">Oleksandr Sova</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-784">
							<time datetime="2017-12-30T03:50:34+00:00">
								December 30, 2017 at 03:50							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hello. Why do you think that <cite>put ports in a separate layer, the you break package by component design</cite>?
 Your packages/modules may strictly require other module which in this 
case may be it’s bounadry. Uncle Bob described it like “plug-in 
approach”. So consider next packages relation structure:<br>
+——————-                        +———————+                       +—————+<br>
| Infrastructure   |                       | UseCase           |                        | App impl    |<br>
| module where |==requires==&gt;| boundary           |&lt;==requires==| where        |<br>
| ControllerA     |                        | where is            |                        | ConcreteA  |<br>
| belongs to       |                       | &lt; I &gt; ContractA  |                        | belongs to  |<br>
+——————-+                      +———————+                       +—————+<br>
Infrastructure do knows about boundary and only about it as a contract 
but dependencies are still inwards. So ControllerA –depends on–|&gt; 
ContractA implemented by ConcreteA. What is breaking this way? Packages 
may require other packages to be a part of it so it’s still top level 
package by component. And packages may be re-used at other 
packages/components so it’s way like plugin. As for example – to publish
 an IDE plugin you don’t have to publish whole IDE with it.</p>
<p id="comment-like-784" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=784&amp;_wpnonce=aabe403fbb" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-784" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=784#respond" onclick='return addComment.moveForm( "div-comment-784", "784", "respond", "14874" )' aria-label="Reply to Oleksandr Sova">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-788" class="comment odd alt depth-3 parent highlander-comment">
			<article id="div-comment-788" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-1" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-788">
							<time datetime="2017-12-31T05:51:28+00:00">
								December 31, 2017 at 05:51							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, I explain it in my reply to hgraca ( <a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-753" rel="nofollow">https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-753</a>
 ). In my implementation of hexagonal architecture, I have a jar for 
every port and another jar for the core (hexagon = core + ports). Ports 
are the boundary of the hexagon. The outside world (adapters) access the
 inside through ports. I have a jar for every adapter. Core depends on 
ports (interfaces), and every adapter depends on the port that it 
implements. Ports isolate the core from the outside. So say you have 
ComponentA and ComponentB in the core. RepositoryA and RepositoryB are 
interfaces belonging to the persistence port for accessing the database,
 so they both belong to the “persistence port”. But this breaks “package
 by feature” (because RepositoryA should belong to ComponentA, and 
RepositoryB to ComponentB). My solution was to add a RepositoryA class 
in ComponentA, that just gets injected the RepositoryA interface of the 
port, and forwards every method call to the port. Same for B.</p>
<p>Apologize to hgraca, this is your blog, not mine (I don’t have any), 
but I’ve answered as the question was about something I said.</p>
<p>Regards,<br>
Juan.</p>
<p id="comment-like-788" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=788&amp;_wpnonce=b9ecb5d57e" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-788" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-790" class="comment byuser comment-author-hgraca bypostauthor even depth-3 highlander-comment">
			<article id="div-comment-790" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-11" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-790">
							<time datetime="2017-12-31T07:41:40+00:00">
								December 31, 2017 at 07:41							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>No need to apologize Juan, the more ppl participate the better.<br>
One of the reasons i created the blog was to give back to the community, and we are all part of it <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p id="comment-like-790" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=790&amp;_wpnonce=8fd829ef6b" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-790" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-753" class="comment odd alt thread-even depth-1 parent highlander-comment">
			<article id="div-comment-753" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-2" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-753">
							<time datetime="2017-12-19T13:40:44+00:00">
								December 19, 2017 at 13:40							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thanks for your answer, I appreciate it a lot too, because the 
architecture of my project is very similar to yours, I’m a fan of ports 
and adapters architecture and DDD. When I saw this post I said: “this is
 amazing, perfect”. And the picture of the whole architecture is 
awesome. In general, your posts are great. I say it because it’s what I 
really think.</p>
<p>By secondary ports I mean what you call just ports. They belong to 
the core but I split them phisically apart (core = domain model + 
secondary ports). Domain model depends on secondary ports. They are 
interfaces for talking to external actors 
(systems,humans,services,databases or whatever). The language of the 
port methods signatures are the language of the core. A secondary 
adapter implements (depends on) the secondary port for a specific 
external actor and technology. I said Repository (persistence port) as 
an example of secondary port. In my case I split the core in modules 
(DDD concept), more or less is what you call component. A module has one
 or more aggregates, each one with its repository interface. This 
aggregates repo interfaces should be the secondary port, but if I place 
them (one per aggregate) in the port, then I break the “package by 
feature” design. So I decided to add kind of a “port proxy” in the 
domain model, that gets the port injected and forward the method calls 
to the port. By this I add complexity and duplication. But if I don’t do
 it, then the persistence adapter (repo implementation) should depend on
 the whole domain model, and that’s not correct from my point of view. 
Every secondary adapter must depend just on the secondary port that it 
implements.</p>
<p>I think your answer (“Repositories are specific to a component, si I 
place them in its specific component. They depend on the ORM port, it is
 injected in the repository constructor”) is more or less what I mean.</p>
<p>Thank you very much.</p>
<p>PD: Just one more question: do you have a persistence model in the 
persistence port, different from the domain model, and a translator 
between the two? Components of the domain model depend on persistence 
port and persistence adapter depends on the port too. Port doesn’t 
depend on anything, so it knows nothing about the domain model.</p>
<p id="comment-like-753" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=753&amp;_wpnonce=7f8b297bf3" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-753" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=753#respond" onclick='return addComment.moveForm( "div-comment-753", "753", "respond", "14874" )' aria-label="Reply to Juan">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-754" class="comment byuser comment-author-hgraca bypostauthor even depth-2 parent highlander-comment">
			<article id="div-comment-754" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-12" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-754">
							<time datetime="2017-12-19T19:50:39+00:00">
								December 19, 2017 at 19:50							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Thank you again for your comment, quite interesting how you do see it, and how similarly we do it! <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p>I’m not quite sure what you mean by a persistence model. However, I 
can say that the persistence port indeed knows nothing of the domain 
although all ports should be designed to fit what the domain needs as 
opposed to what would be easier to implement by the adapter. Otherwise, 
the adapter is just a wrapper around the tool. In other words, we should
 first design the port as it would be easier to use by the components, 
and then implement the adapter.<br>
In my concrete case, I use Doctrine (similar to Hibernate) which is an 
ORM that uses a data-mapper pattern, as opposed to an active-record 
pattern, so I can indeed have a data model completely different from the
 domain model, although that is not usually the case, and the mapping 
from domain model to data model is set up with configuration files 
understood by the ORM itself.</p>
<p>Did this answer your question? <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p id="comment-like-754" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=754&amp;_wpnonce=353aff4648" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-754" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=754#respond" onclick='return addComment.moveForm( "div-comment-754", "754", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-755" class="comment odd alt depth-3 highlander-comment">
			<article id="div-comment-755" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-3" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-755">
							<time datetime="2017-12-19T20:36:28+00:00">
								December 19, 2017 at 20:36							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>I totally agree with you.</p>
<p>By persistence model I mean the model mapped to the database. I use 
jpa and xml mapping, in order to not polute the entities with 
annotations. Again, I think it is similar to yours.</p>
<p>Of course you did answer my question.</p>
<p>Thanks again.</p>
<p>I’m looking forward to see your next articles.</p>
<p>Regards, Juan.</p>
<p id="comment-like-755" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=755&amp;_wpnonce=9ba777a3f8" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-755" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-838" class="comment byuser comment-author-jantonioreyes even thread-odd thread-alt depth-1 parent highlander-comment">
			<article id="div-comment-838" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/78b46ee0c937cbdc06c03fcd6ede8306.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-78b46ee0c937cbdc06c03fcd6ede8306-0" width="48" height="48">						<b class="fn">jantonioreyes</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-838">
							<time datetime="2018-01-15T14:09:44+00:00">
								January 15, 2018 at 14:09							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Great article.<br>
Thanks for this post.</p>
<p>I’ve a doubt about just one point, where you’re talking about put 
repository interfaces in the Application Layer. According to DDD we use 
to put them in Domain, so if they belong to Application, where they must
 be implemented?<br>
If interfaces are in Application, and implementations in Infrastructure,
 must Infrastructure have dependencies from Domain and Application 
layers?</p>
<p>Thank you so much, and keep it going!</p>
<p>Regards.</p>
<p id="comment-like-838" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=838&amp;_wpnonce=ee3ce6335a" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-838" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=838#respond" onclick='return addComment.moveForm( "div-comment-838", "838", "respond", "14874" )' aria-label="Reply to jantonioreyes">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-841" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-2 parent highlander-comment">
			<article id="div-comment-841" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-13" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-841">
							<time datetime="2018-01-15T23:52:37+00:00">
								January 15, 2018 at 23:52							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi, tkx for your comment.</p>
<p>I put both the repository interface and the implementation(s) in the application layer.<br>
I see the repository interfaces as an abstraction over a query language.
 So there can be different implementations of the same repository 
interface, each implementation using a different query language, ie one 
implementation with DQL, another with SQL, another with Mongo QL, …<br>
Each implementation gets injected a persistence interface which lives  
and is implemented in the infrastructure layer. The persistence 
interface implementation injected can be different for all different 
repositories or it can be the same by using a strategy pattern.</p>
<p>I hope this was clear…</p>
<p>In my next post i have an example of this implementation. <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p id="comment-like-841" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=841&amp;_wpnonce=ecd396e5ae" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-841" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=841#respond" onclick='return addComment.moveForm( "div-comment-841", "841", "respond", "14874" )' aria-label="Reply to hgraca">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-842" class="comment even depth-3 parent highlander-comment">
			<article id="div-comment-842" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-4" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-842">
							<time datetime="2018-01-16T00:54:56+00:00">
								January 16, 2018 at 00:54							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi hgraca, I don’t agree with you at this point. I think that 
neither putting repo interfaces nor their implementations in the 
application layer is right from a DDD point of view.</p>
<p>Repo interfaces belong to the domain, one Repo per Aggregate Root. 
And the implementation should live in the infraestructure layer, 
implementing the repo methods (named using the UL) with languages 
according to the storage (SQL, Mogo, etc).</p>
<p>The application layer, as the direct client of the domain, uses the repositories interfaces.</p>
<p>Persistence is not a cross-cutting concern, like transactions, 
logging, exception handling, etc, so persistence shouldn’t live in the 
application layer.</p>
<p>Well that’s my point of view from what I’ve been learning about DDD. Maybe I’m wrong.</p>
<p>In response to jantonioreyes, I wanted to say that in DDD, 
infraestructure depends on both application layer and domain model. In 
order to implement cross-cutting concerns, the interface lives in the 
application layer and the implementation lives in the infraestructure.</p>
<p>Regards, Juan.</p>
<p id="comment-like-842" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=842&amp;_wpnonce=322feb41b3" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-842" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
		<li id="comment-844" class="comment byuser comment-author-hgraca bypostauthor odd alt depth-3 highlander-comment">
			<article id="div-comment-844" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/9e8bab4f1410e0e6e963d83cd848288a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-9e8bab4f1410e0e6e963d83cd848288a-14" width="48" height="48">						<b class="fn"><a href="http://herbertograca.com/" rel="external nofollow" class="url">hgraca</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-844">
							<time datetime="2018-01-16T07:47:21+00:00">
								January 16, 2018 at 07:47							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>That’s fair enough <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p>However, if you place repository interfaces in the domain layer, that
 means that an Entity could eventually use a repository. I think that 
should never be the case. So by putting the repository interface in the 
application layer, you explicitly say that a domain object should never 
use a repository.</p>
<p>Collections, on the other hand, yes. We can have a User and a Role 
entities in a 1-* relation, and then the User will contain a collection 
of Roles, and that collection can contain business rules inside.</p>
<p>I have never encountered a case where a domain object (entity, value 
obj, collection, specification, …) would need to know about persistence.</p>
<p>A use case, on the other hand, needs to know to what entities it 
applies to, needs to get them from persistence, tell them to do 
something, and persist them again.</p>
<p>Furthermore, I don’t think the repository implementation should live 
in the infrastructure because a repository is specific to a component, 
it should not be used in other components. A repository is not cross 
cutting through components, unlike the persistence interface which will 
be used by all components.</p>
<p>This is how I see it anyway <img draggable="false" class="emoji" alt="🙂" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1f642.svg"></p>
<p id="comment-like-844" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=844&amp;_wpnonce=cbbacf57d5" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-844" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

							</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-845" class="comment byuser comment-author-jantonioreyes even thread-even depth-1 parent highlander-comment">
			<article id="div-comment-845" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/78b46ee0c937cbdc06c03fcd6ede8306.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-78b46ee0c937cbdc06c03fcd6ede8306-1" width="48" height="48">						<b class="fn">jantonioreyes</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-845">
							<time datetime="2018-01-16T10:58:50+00:00">
								January 16, 2018 at 10:58							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi,</p>
<p>I agree that entities should never use a repository, but not entirely
 sure about its use in Doman Services, f.e. when applying business rules
 regarding some type of data validation (stored in database) before a 
command execution.</p>
<p>However, if you place repository in Application layer, the use of 
repositories is restricted in Domain, but they could be used from 
Presentation, as it can access to all Application functionality. And in a
 DDD context, I don’t think this is really correct, as any access from 
UI should be through Application Services or Command/Queries Handlers.</p>
<p>Anyway, I don’t agree with @Juan about that infrastructure depends on
 both application layer and domain model in DDD. From my point of view, 
dependencies in DDD do in this way:</p>
<p>Application –&gt; Domain &lt;– Infrastructure</p>
<p>Where domain is the core of everything.</p>
<p>It’ll be interesting to know your opinions about all the things discussed here.</p>
<p>Regards.</p>
<p id="comment-like-845" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=845&amp;_wpnonce=fc9027e76e" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-845" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=845#respond" onclick='return addComment.moveForm( "div-comment-845", "845", "respond", "14874" )' aria-label="Reply to jantonioreyes">Reply</a></div>			</article><!-- .comment-body -->
<ol class="children">
		<li id="comment-846" class="comment odd alt depth-2 highlander-comment">
			<article id="div-comment-846" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/f6d9e22f3b8e99baeda85717f28c30aa.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-f6d9e22f3b8e99baeda85717f28c30aa-5" width="48" height="48">						<b class="fn">Juan</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#comment-846">
							<time datetime="2018-01-16T12:31:40+00:00">
								January 16, 2018 at 12:31							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Hi @jantonioreyes. Infraestructure must depend on Application 
Layer in order to implement the application logic that needs to deal 
with technology or frameworks.</p>
<p>For example, transactions are a cross-cutting concern that should 
live in the application layer, and the implementation (with Spring 
framework for example) should live in the infraestrucure.</p>
<p>Sending a notification is another example of application logic. The 
interface lives in the application layer and the implementation (using 
email, sms or whatever) lives in the infraestructure.</p>
<p>Look at the layered architecture diagram using DIP (page 124 in the 
book “Implementing DDD” by Vaughn Vernon). Infraestructure depends on 
all layers.</p>
<p>I don’t use layered architecture though. I use hexagonal 
architecture, but it’s similar: application logic belongs to the inside 
of the hexagon, and it can use ports (interfaces that belongs to the 
hexagon too). This ports are implemeted by adapters (the 
infraestructure, the outside of the hexagon).</p>
<p>Regards, Juan.</p>
<p id="comment-like-846" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?like_comment=846&amp;_wpnonce=2e8cbf0236" class="comment-like-link needs-login" rel="nofollow" data-blog="98044927"><span>Like</span></a><span id="comment-like-count-846" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/?replytocom=846#respond" onclick='return addComment.moveForm( "div-comment-846", "846", "respond", "14874" )' aria-label="Reply to Juan">Reply</a></div>			</article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://herbertograca.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">
				<input id="highlander_comment_nonce" name="highlander_comment_nonce" value="53c3722317" type="hidden"><input name="_wp_http_referer" value="/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/" type="hidden">
<input name="hc_post_as" id="hc_post_as" value="guest" type="hidden">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px none; padding: 0px; box-sizing: content-box; overflow-wrap: break-word; height: 0px !important; min-height: 0px !important; overflow: hidden; transition: none 0s ease 0s; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none; word-spacing: 0px; text-indent: 0px; line-height: 18px; width: 718px;" class="autosizejs ">Enter your comment here...</textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 38px; overflow: hidden; overflow-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
		</li></ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ad516503a11cd5ca435acc9bb6523536.png" alt="Gravatar" class="no-grav" width="25">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email"></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text"></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url"></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ad516503a11cd5ca435acc9bb6523536.png" alt="WordPress.com Logo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" type="hidden">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your <span class="skimlinks-unlinked">WordPress.com</span> account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'wordpress'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ad516503a11cd5ca435acc9bb6523536.png" alt="Twitter picture" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" type="hidden">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'twitter'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ad516503a11cd5ca435acc9bb6523536.png" alt="Facebook photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" type="hidden">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'facebook'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/ad516503a11cd5ca435acc9bb6523536.png" alt="Google+ photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" type="hidden">
				<input name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" type="hidden">
				<input name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" type="hidden">
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'googleplus'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input name="subscribe" id="subscribe" value="subscribe" style="width: auto;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>




<p class="form-submit" style="display: none;"><input name="submit" id="comment-submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="14874" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="0beccc8d73" type="hidden"></p>
<input name="genseq" value="1516449278" type="hidden">
<p style="display: none;"></p>			<input id="ak_js" name="ak_js" value="1516449279521" type="hidden"></form>
			</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

<div id="secondary" class="widget-area" role="complementary">
	<aside id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a href="https://twitter.com/hgraca" target="_blank"><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/logo.png" alt="twitter" width="50px"></a>
<a href="https://medium.com/@herberto.graca" target="_blank"><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/1z5S7iSWqfgyvCd74A-prZg.png" alt="medium" width="50px"></a>
</div></aside><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://herbertograca.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input class="search-field" placeholder="Search …" name="s" type="search">
				</label>
				<input class="search-submit" value="Search" type="submit">
			</form></aside><aside id="nav_menu-3" class="widget widget_nav_menu"><div class="menu-menu-container"><ul id="menu-menu" class="menu"><li id="menu-item-6" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6"><a title="Home" href="https://herbertograca.com/">Home</a></li>
<li id="menu-item-15243" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-15243"><a href="https://herbertograca.com/category/development/">Development</a></li>
<li id="menu-item-15241" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-15241"><a href="https://herbertograca.com/category/development/architecture/">Architecture</a></li>
<li id="menu-item-332" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-332"><a href="https://herbertograca.com/dev-theory-articles-listing/">Dev Curricula</a></li>
<li id="menu-item-609" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-609"><a href="https://herbertograca.com/category/development/book-notes/">Book notes</a>
<ul class="sub-menu">
	<li id="menu-item-762" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-762"><a href="https://herbertograca.com/category/development/book-notes/domain-driven-design-by-eric-evans/">Domain Driven Design by Eric Evans</a></li>
	<li id="menu-item-3566" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3566"><a href="https://herbertograca.com/category/development/book-notes/patterns-of-enterprise-application-architecture-by-martin-fowler/">Patterns of Enterprise Application Architecture by Martin Fowler</a></li>
	<li id="menu-item-3567" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3567"><a href="https://herbertograca.com/category/development/book-notes/patterns-principles-and-practices-of-domain-driven-design-by-scott-millett-and-nick-tune/">Patterns Principles and Practices of Domain-Driven Design by Scott Millett and Nick Tune</a></li>
	<li id="menu-item-4330" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4330"><a href="https://herbertograca.com/category/development/book-notes/lean-architecture-by-james-coplien-and-gertrud-bjornvig/">Lean Architecture by James Coplien and Gertrud Bjornvig</a></li>
</ul>
</li>
<li id="menu-item-573" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-573"><a href="https://herbertograca.com/10-2/">About</a></li>
</ul></div></aside><aside id="linkcat-559225046" class="widget widget_links"><h1 class="widget-title">Top Posts &amp; Pages</h1>
	<ul class="xoxo blogroll">
<li><a href="https://herbertograca.com/2017/07/03/the-software-architecture-chronicles/">The Software Architecture Chronicles</a></li>
<li><a href="https://herbertograca.com/2017/01/26/microservices-architecture/">Microservices architecture: What the gurus say about it</a></li>
<li><a href="https://herbertograca.com/2015/11/01/teams-building-managing-leading-performing/">Teams: building, managing, leading, performing</a></li>
<li><a href="https://herbertograca.com/2017/02/08/ddd-europe-2017/">DDD Europe 2017: The 3 talks I most enjoyed</a></li>
<li><a href="https://herbertograca.com/dev-theory-articles-listing/">Dev curricula</a></li>

	</ul>
</aside>
<aside id="blog_subscription-2" class="widget widget_blog_subscription"><h1 class="widget-title"><label for="subscribe-field">Follow Blog via Email</label></h1>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
											<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
<p>Join 1,086 other followers</p>
						<p><input name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" id="subscribe-field" type="text"></p>
					
					<p>
						<input name="action" value="subscribe" type="hidden">
						<input name="blog_id" value="98044927" type="hidden">
						<input name="source" value="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/" type="hidden">
						<input name="sub-type" value="widget" type="hidden">
						<input name="redirect_fragment" value="blog_subscription-2" type="hidden">
						<input id="_wpnonce" name="_wpnonce" value="f2eee7de6e" type="hidden">						<input value="Follow" type="submit">
					</p>
				</form>
			
</aside><aside id="rss-2" class="widget widget_rss"><h1 class="widget-title"><a class="rsswidget" href="https://8thlight.com/blog/feed/rss.xml" title="Syndicate this content"><img style="background: orange; color: white; border: none;" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/rss.png" alt="RSS" width="14" height="14"></a> <a class="rsswidget" href="https://8thlight.com/blog" title="Posts on software craftsmanship and consulting from 8th Light's designers and crafters.">8th Light</a></h1><ul><li><a class="rsswidget" href="https://8thlight.com/blog/malcolm-newsome/2017/11/15/the-biggest-software-mistake-small-business-owners-make.html" title="Since we created our Managed Software Services unit to focus squarely on Software Support and Maintenance services, I've had the opportunity to work with and talk to a lot of small business owners who were confronted with major problems because of this one thing: they relied exclusively on one sole developer to manage all of their software needs. It mak […]">The Biggest Software Mistake That Small Business Owners Make</a></li><li><a class="rsswidget" href="https://8thlight.com/blog/colin-jones/2017/10/24/advice-for-early-career-developers.html" title="Several times a week I get emails or LinkedIn messages from recent or soon-to-be code school graduates, asking to buy me coffee or jump on a phone call to share career advice. I've been in a similar spot to where they are, trying to excel in the industry and looking for mentors. In fact, I kind of feel like I've been an apprentice for the last 11 y […]">Advice for early-career developers</a></li><li><a class="rsswidget" href="https://8thlight.com/blog/christoph-gockel/2017/10/23/legacy-code-spying-on-global-functions.html" title="As developers we often find ourselves in a situation where we first need to get an existing piece of functionality under test before we can safely add a new feature. In a recent project we ran into exactly that issue with a large codebase that had low test coverage. The project's language was PHP and the code we needed to extend relied on a global funct […]">Legacy Code: Spying On Global Functions</a></li></ul></aside><aside id="rss-4" class="widget widget_rss"><h1 class="widget-title"><a class="rsswidget" href="http://blog.cleancoder.com/atom.xml" title="Syndicate this content"><img style="background: orange; color: white; border: none;" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/rss.png" alt="RSS" width="14" height="14"></a> <a class="rsswidget" href="" title="">The Clean Code</a></h1><ul><li>The Citizenship Argument</li><li>Operating Behind the Power Curve</li><li>Excuses</li></ul></aside><aside id="rss-3" class="widget widget_rss"><h1 class="widget-title"><a class="rsswidget" href="https://martinfowler.com/feed.atom" title="Syndicate this content"><img style="background: orange; color: white; border: none;" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/rss.png" alt="RSS" width="14" height="14"></a> <a class="rsswidget" href="" title="">Martin Fowler</a></h1><ul><li>Bliki: IntegrationTest</li><li>FAQ for Product-Mode Thinking</li><li>Challenges of Product-mode</li></ul></aside></div><!-- #secondary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
						<div class="site-info">
				<a href="https://wordpress.com/?ref=footer_website">Create a free website or blog at WordPress.com.</a>
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->
</div><!-- #page -->

<!--  -->
<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/wpgroho.js"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-9e8bab4f1410e0e6e963d83cd848288a">
	</div>
	<div class="grofile-hash-map-5385a63fb63aa282d92c929fa27df283">
	</div>
	<div class="grofile-hash-map-9e8bab4f1410e0e6e963d83cd848288a">
	</div>
	<div class="grofile-hash-map-5cfb78328c3542047d6cb4014507f34f">
	</div>
	<div class="grofile-hash-map-0305d7bb35aba50c6ca8448965a8f95e">
	</div>
	<div class="grofile-hash-map-4fdaf861a4e2146ef4d2cac924453029">
	</div>
	<div class="grofile-hash-map-91717ad94f01b6be1e63111f23e3660c">
	</div>
	<div class="grofile-hash-map-ae9d562f99b12dba78ea4fafa5d76ef4">
	</div>
	<div class="grofile-hash-map-cbec86946b25a1679fceb265fd54d1ce">
	</div>
	<div class="grofile-hash-map-378eefea3af018ef9279ad59fbc0bfff">
	</div>
	<div class="grofile-hash-map-625bfdcc5ebe17f847a1de7f6ce4c0a0">
	</div>
	<div class="grofile-hash-map-98442eeeeb11844d9992d93562f892ce">
	</div>
	<div class="grofile-hash-map-349d44c089cf2ec5f1c800f158fa2458">
	</div>
	<div class="grofile-hash-map-6557b36c09c57b7d60dd7e0a2789f938">
	</div>
	<div class="grofile-hash-map-4763b4d6e4b51ca8fb4dbf4620f71d81">
	</div>
	<div class="grofile-hash-map-f6d9e22f3b8e99baeda85717f28c30aa">
	</div>
	<div class="grofile-hash-map-78b46ee0c937cbdc06c03fcd6ede8306">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging 
In\u2026","submittingText":"Posting 
Comment\u2026","postCommentText":"Post 
Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s:
 You are commenting using your %2$s account.","logoutText":"Log 
Out","loginText":"Log 
In","connectURL":"https:\/\/herbertograca.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/herbertograca.wordpress.com\/wp-login.php?action=logout&_wpnonce=9e2f533bc2","homeURL":"https:\/\/herbertograca.com\/","postID":"14874","gravDefault":"identicon","enterACommentError":"Please
 enter a comment","enterEmailError":"Please enter your email address 
here","invalidEmailError":"Invalid email 
address","enterAuthorError":"Please enter your name 
here","gravatarFromEmail":"This picture will show whenever you leave a 
comment. Click to customize it.","logInToExternalAccount":"Log in to use
 details from one of these 
accounts.","change":"Change","changeAccount":"Change 
Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
/*
 ]]> */
</script>
<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_003.js"></script>

	<div id="carousel-reblog-box">
		<form action="#" name="carousel-reblog">
			<textarea id="carousel-reblog-content" name="carousel-reblog-content" placeholder="Add your thoughts here... (optional)"></textarea>
			<label for="carousel-reblog-to-blog-id" id="carousel-reblog-lblogid">Post to</label>
			<select name="carousel-reblog-to-blog-id" id="carousel-reblog-to-blog-id">
						</select>

			<div class="submit">
				<span class="canceltext"><a href="#" class="cancel">Cancel</a></span>
				<input name="carousel-reblog-submit" class="button" id="carousel-reblog-submit" value="Reblog Post" type="submit">
				<input id="carousel-reblog-blog-id" value="98044927" type="hidden">
				<input id="carousel-reblog-blog-url" value="https://herbertograca.com" type="hidden">
				<input id="carousel-reblog-blog-title" value="@herbertograca" type="hidden">
				<input id="carousel-reblog-post-url" value="" type="hidden">
				<input id="carousel-reblog-post-title" value="" type="hidden">
			</div>

			<input id="_wpnonce" name="_wpnonce" value="fcd1b71a60" type="hidden"><input name="_wp_http_referer" value="/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/" type="hidden">		</form>

		<div class="arrow"></div>
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = 
{"https:\/\/herbertograca.com\/2017\/11\/16\/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together\/":14874};

	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<link rel="stylesheet" id="all-css-0-3" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/jetpack-carousel.css" type="text/css" media="all">
<!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel-ie8fix.css?m=1412618825h&#038;ver=20121024' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="all-css-2-3" href="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/tiled-gallery.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading..."};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var actionbardata = 
{"siteID":"98044927","siteName":"@herbertograca","siteURL":"https:\/\/herbertograca.com","icon":"<img
 alt='' 
src='https:\/\/secure.gravatar.com\/blavatar\/448a31aa6850fbccb7cc0021392a0d0b?s=50&d=https%3A%2F%2Fs1.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png'
 class='avatar avatar-50' height='50' width='50' 
\/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/independent-publisher-2","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/herbertograca.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F","themeURL":"https:\/\/wordpress.com\/theme\/independent-publisher-2\/","xhrURL":"https:\/\/herbertograca.com\/wp-admin\/admin-ajax.php","nonce":"5aca829253","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input
 type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"f2eee7de6e\" 
\/>","referer":"https:\/\/herbertograca.com\/2017\/11\/16\/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together\/","canFollow":"1","feedID":"37045174","statusMessage":"","customizeLink":"https:\/\/herbertograca.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fherbertograca.wordpress.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F","postID":"14874","shortlink":"https:\/\/wp.me\/p6DnXN-3RU","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/herbertograca.com\/14874","statsLink":"https:\/\/wordpress.com\/stats\/post\/14874\/herbertograca.com","i18n":{"view":"View
 
site","follow":"Follow","following":"Following","edit":"Edit","login":"Log
 in","signup":"Sign up","customize":"Customize","report":"Report this 
content","themeInfo":"Get theme: Independent Publisher 
2","shortlink":"Copy shortlink","copied":"Copied","followedText":"New 
posts from this site will now appear in your <a 
href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this
 bar","unfoldBar":"Expand this bar","editSubs":"Manage 
subscriptions","viewReader":"View site in Reader","viewReadPost":"View 
post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email 
address","followers":"Join 1,086 other followers","alreadyUser":"Already
 have a WordPress.com account? <a 
href=\"https:\/\/herbertograca.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F\">Log
 in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var jetpackCarouselStrings = 
{"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/herbertograca.com\/wp-admin\/admin-ajax.php","nonce":"0c1e2e0a4a","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post
 Comment","write_comment":"Write a 
Comment...","loading_comments":"Loading 
Comments...","download_original":"View full size <span 
class=\"photo-size\">{0}<span 
class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please
 be sure to submit some text with your 
comment.","no_comment_email":"Please provide an email address to 
comment.","no_comment_author":"Please provide your name to 
comment.","comment_post_error":"Sorry, but there was an error posting 
your comment. Please try again later.","comment_approved":"Your comment 
was approved.","comment_unapproved":"Your comment is in 
moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter
 Speed","focal_length":"Focal 
Length","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/herbertograca.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F","blog_id":"98044927","local_comments_commenting_as":"<fieldset><label
 for=\"email\">Email (Required)<\/label> <input type=\"text\" 
name=\"email\" class=\"jp-carousel-comment-form-field 
jp-carousel-comment-form-text-field\" 
id=\"jp-carousel-comment-form-email-field\" 
\/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> 
<input type=\"text\" name=\"author\" 
class=\"jp-carousel-comment-form-field 
jp-carousel-comment-form-text-field\" 
id=\"jp-carousel-comment-form-author-field\" 
\/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input 
type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field 
jp-carousel-comment-form-text-field\" 
id=\"jp-carousel-comment-form-url-field\" 
\/><\/fieldset>","reblog":"Reblog","reblogged":"Reblogged","reblog_add_thoughts":"Add
 your thoughts here... 
(optional)","reblogging":"Reblogging...","post_reblog":"Post 
Reblog","stats_query_args":"blog=98044927&v=wpcom&tz=1&user_id=0&subd=herbertograca","is_public":"1","reblog_enabled":""};
/*
 ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/a_002.js"></script><div id="actionbar" class="actnbr-pub-independent-publisher-2 actnbr-has-follow"><ul><li class="actnbr-btn actnbr-hidden"> 			    	<a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a> 			    	<div class="actnbr-popover tip tip-top-left actnbr-notice"> 			    		<div class="tip-arrow"></div> 			    		<div class="tip-inner actnbr-follow-bubble"></div> 			    	</div> 			    </li><li class="actnbr-ellipsis actnbr-hidden"> 			  <svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 			  <div class="actnbr-popover tip tip-top-left actnbr-more"> 			  	<div class="tip-arrow"></div> 			  	<div class="tip-inner"> 				  <ul> 				    <li class="actnbr-sitename actnbr-hidden"><a href="https://herbertograca.com/"><img alt="" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/448a31aa6850fbccb7cc0021392a0d0b.png" class="avatar avatar-50" width="50" height="50"> @herbertograca</a></li> 				   	<li class="actnbr-folded-customize actnbr-hidden"><a href="https://herbertograca.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fherbertograca.wordpress.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 				    <li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a></li> 					<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li> 				    <li class="actnbr-login actnbr-hidden"><a href="https://herbertograca.wordpress.com/wp-login.php?redirect_to=https%3A%2F%2Fherbertograca.com%2F2017%2F11%2F16%2Fexplicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together%2F">Log in</a></li> 				     				    <li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p6DnXN-3RU">Copy shortlink</a></li> 				    <li class="flb-report actnbr-hidden"><a href="http://en.wordpress.com/abuse/">Report this content</a></li> 				     				     				    <li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage subscriptions</a></li> 				    <li class="actnbr-fold actnbr-hidden"><a href="">Collapse this bar</a></li> 			      </ul> 			    </div> 		      </div> 		    </li> 	      </ul></div>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "herbertograca.wordpress.com";
	</script>
	<script type="text/javascript" defer="defer" src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/725X1342.bin"></script>		<iframe src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/w.js" type="text/javascript" async="" defer="defer"></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', 
{'blog_id':'98044927','blog_tz':'1','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view',
 
{'blog':'98044927','v':'wpcom','tz':'1','user_id':'0','post':'14874','subd':'herbertograca'}]);
_stq.push(['extra',
 
{'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWtpP0NsWnVkPS9sL0ViLndld3BERy5kZENtZ0FZSn5QOFdSLGs5aFsmZVNYM3JyQWFaZCtHZDZoZ0ZYc2N2QmUvM3luMnRSaV0mdk5CfixOJjQsWz1sK0w9JWIyc1UxTEEsYy8tQS5dVXRsdlU1TCwwMlctfnJDfFdDZS0xN2t1MThXRVB5MEFILm5dLG14Ry03X0dHbS5tQz8tXz0yVFpqd2hHeHxMckR+UCUseiVHdkNRQSstOX4wMEcrQXc5LllUWVk5LWNSTVYlYUw3aT9uX2N0eld5eGFjJjBWMDMrd1s3UW9mMlh6cUF0WVA/JkYmbFtPQ29kNiYvWEpEREdtZ2klRGtvVV10'}]);
_stq.push([
 'clickTrackerInit', '98044927', '14874' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + 
wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + 
wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + 
'//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba='
 + Math.random();
	}
	
}
</script>


<div class="comment-likes-overlay" style="display: none;"></div><img src="DDD,%20Hexagonal,%20Onion,%20Clean,%20CQRS,%20%E2%80%A6%20How%20I%20put%20it%20all%20together%20%E2%80%93%20@herbertograca_pliki/g.gif" alt=":)" id="wpstats"></body></html>